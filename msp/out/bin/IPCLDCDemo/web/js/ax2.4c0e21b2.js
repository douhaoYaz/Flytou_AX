(self["webpackChunkwebapp"]=self["webpackChunkwebapp"]||[]).push([[559],{8139:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return p}});var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"total_container"},[n("el-container",{staticClass:"preview_outside_container"},[n("el-container",{staticClass:"preview_main_container"},[n("el-main",{staticClass:"preview_capture_left_container"},[n("el-container",{staticClass:"preview_container"},[n("el-main",{ref:"axMain",staticClass:"video_container"},[n("video",{ref:"axVideoRef",staticClass:"axVideo",attrs:{id:"myVideo",autoplay:"",muted:"",playsinline:"",oncontextmenu:"return false;"},domProps:{muted:!0}})]),n("el-footer",{staticClass:"video_controls_container",attrs:{height:"40px"}},[n("div",{staticClass:"left_controls_container"},[n("div",{staticClass:"size_option"},[n("el-dropdown",{attrs:{trigger:"click"},on:{command:e.changeSizeOption}},[n("el-button",{staticClass:"el-dropdown-link",attrs:{type:"text"}},[e._v(e._s(e.sizeOptions[e.sizeOptionInd].label))]),n("el-dropdown-menu",{attrs:{slot:"dropdown","append-to-body":!1},slot:"dropdown"},e._l(e.sizeOptions,(function(t){return n("el-dropdown-item",{key:t.id,attrs:{command:t.id+"",icon:t.icon}},[e._v(e._s(t.label))])})),1)],1)],1),n("div",[n("el-dropdown",{attrs:{trigger:"click"},on:{command:e.changeStream}},[n("el-button",{staticClass:"el-dropdown-link",attrs:{type:"text"}},[e._v(e._s(e.streamOptions[e.streamOptionInd].label))]),n("el-dropdown-menu",{attrs:{slot:"dropdown","append-to-body":!1},slot:"dropdown"},e._l(e.streamOptions,(function(t){return n("el-dropdown-item",{key:t.id,attrs:{command:t.id+"",icon:t.icon}},[e._v(e._s(t.label))])})),1)],1)],1)]),n("div",{staticClass:"right_controls_container"},[n("div",{staticClass:"draw_option"},[n("el-tooltip",{attrs:{effect:"dark",content:"抓拍",placement:"top-end",enterable:!1}},[n("el-button",{class:{draw_button_enable:!0,draw_button_disable:!1},attrs:{icon:"el-icon-camera-solid"},on:{click:e.onSnapshot}})],1)],1),n("div",{staticClass:"draw_option"},[n("el-tooltip",{attrs:{effect:"dark",content:"录入人像信息",placement:"top-end",enterable:!1}},[n("el-button",{directives:[{name:"show",rawName:"v-show",value:e.isSearchImg&&"facehuman"==e.detect_mode,expression:"isSearchImg && detect_mode == 'facehuman'"}],class:{draw_button_enable:!0,draw_button_disable:!1},attrs:{icon:"el-icon-user-solid"},on:{click:e.recordFaceinfo}})],1)],1),n("div",{staticClass:"draw_option"},[n("el-tooltip",{attrs:{effect:"dark",content:e.isRecStart?"停止录像":"开启录像",placement:"top-end",enterable:!1}},[n("el-button",{class:{draw_button_enable:!e.isRecStart,draw_button_disable:e.isRecStart},attrs:{disabled:!1===e.rec_enable,icon:"el-icon-video-camera-solid"},on:{click:e.onRecording}})],1)],1),n("div",{staticClass:"full_option"},[n("el-tooltip",{attrs:{effect:"dark",content:e.isFullScreen?"退出全屏":"进入全屏",placement:"top-end",enterable:!1}},[n("el-button",{staticClass:"full_button",attrs:{icon:e.screenIcon},on:{click:e.doScreen}})],1)],1)])])],1)],1),n("el-aside",{directives:[{name:"show",rawName:"v-show",value:"ai"==e.mode_option,expression:"mode_option == 'ai'"}],staticClass:"side_identify_events_container",attrs:{width:"500px"}},[n("el-container",{staticClass:"identify_events_container"},[n("el-header",{staticClass:"identify_container"},[n("el-row",{staticClass:"image_info_container"},[n("el-col",{staticClass:"image_col",attrs:{span:12}},[n("div",{staticClass:"image-large"},[""==e.currentImg.src?n("i",{staticClass:"el-icon-picture-outline"}):e._e(),""!=e.currentImg.src?n("img",{staticClass:"image-large",attrs:{src:e.currentImg.src,crossOrigin:"anonymous"},on:{click:function(t){return e.look(e.currentImg)}}}):e._e()])]),n("el-col",{attrs:{span:12}},[n("div",{staticClass:"info_container"},[n("div",{directives:[{name:"show",rawName:"v-show",value:"facehuman"==e.detect_mode,expression:"detect_mode == 'facehuman'"}],staticClass:"info_text"},[e._v(" 性别： "+e._s(e.currentImg.info.gender)+" ")]),n("div",{directives:[{name:"show",rawName:"v-show",value:"facehuman"==e.detect_mode,expression:"detect_mode == 'facehuman'"}],staticClass:"info_text"},[e._v(" 年龄： "+e._s(e.currentImg.info.age)+" ")]),n("div",{directives:[{name:"show",rawName:"v-show",value:"facehuman"==e.detect_mode,expression:"detect_mode == 'facehuman'"}],staticClass:"info_text"},[e._v(" 口罩： "+e._s(e.currentImg.info.mask)+" ")]),n("div",{directives:[{name:"show",rawName:"v-show",value:"facehuman"==e.detect_mode,expression:"detect_mode == 'facehuman'"}],staticClass:"info_text"},[e._v(" 识别： "+e._s(e.currentImg.info.info)+" ")]),n("div",{directives:[{name:"show",rawName:"v-show",value:"hvcfp"==e.detect_mode,expression:"detect_mode == 'hvcfp'"}],staticClass:"info_text"},[e._v(" 车牌号码："+e._s(e.currentImg.info.number)+" ")]),n("div",{directives:[{name:"show",rawName:"v-show",value:"hvcfp"==e.detect_mode,expression:"detect_mode == 'hvcfp'"}],staticClass:"info_text"},[e._v(" 车牌颜色："+e._s(e.currentImg.info.color)+" ")])])])],1)],1),n("el-main",{staticClass:"events_container"},[n("el-table",{staticClass:"events_table",attrs:{height:"250",data:e.eventList,border:"","highlight-current-row":""}},[n("el-table-column",{attrs:{type:"index",width:"40"}}),n("el-table-column",{attrs:{property:"date",label:"发生时间",width:"190"}}),n("el-table-column",{attrs:{property:"type",label:"事件类型",width:"190"}})],1)],1)],1)],1)],1),n("el-footer",{directives:[{name:"show",rawName:"v-show",value:"hvcfp"==e.detect_mode&&"ai"==e.mode_option,expression:"detect_mode == 'hvcfp' && mode_option == 'ai'"}],staticClass:"hvcfp_img_container"},[n("el-row",{staticClass:"img_list_top"},[n("el-col",{attrs:{span:2}},[n("div",{staticClass:"type_text"},[e._v("人脸")])]),n("el-col",{attrs:{span:11}},e._l(e.image_count/2,(function(t){return n("el-col",{key:t,attrs:{span:3}},[n("div",{staticClass:"image-small"},[""==e.pushHCVFPImages.face[t-1].src?n("i",{staticClass:"el-icon-picture-outline"}):e._e(),""!=e.pushHCVFPImages.face[t-1].src?n("img",{staticClass:"image-small",attrs:{src:e.pushHCVFPImages.face[t-1].src},on:{click:function(n){return e.look(e.pushHCVFPImages.face[t-1])}}}):e._e()])])})),1),n("el-col",{attrs:{span:11}},e._l(e.image_count/2,(function(t){return n("el-col",{key:t,attrs:{span:3}},[n("div",{staticClass:"image-small"},[""==e.pushHCVFPImages.face[e.image_count/2+t-1].src?n("i",{staticClass:"el-icon-picture-outline"}):e._e(),""!=e.pushHCVFPImages.face[e.image_count/2+t-1].src?n("img",{staticClass:"image-small",attrs:{src:e.pushHCVFPImages.face[e.image_count/2+t-1].src},on:{click:function(n){return e.look(e.pushHCVFPImages.face[e.image_count/2+t-1])}}}):e._e()])])})),1)],1),n("el-row",{staticClass:"img_list"},[n("el-col",{attrs:{span:2}},[n("div",{staticClass:"type_text"},[e._v("人形")])]),n("el-col",{attrs:{span:11}},e._l(e.image_count/2,(function(t){return n("el-col",{key:t,attrs:{span:3}},[n("div",{staticClass:"image-small"},[""==e.pushHCVFPImages.body[t-1].src?n("i",{staticClass:"el-icon-picture-outline"}):e._e(),""!=e.pushHCVFPImages.body[t-1].src?n("img",{staticClass:"image-small",attrs:{src:e.pushHCVFPImages.body[t-1].src},on:{click:function(n){return e.look(e.pushHCVFPImages.body[t-1])}}}):e._e()])])})),1),n("el-col",{attrs:{span:11}},e._l(e.image_count/2,(function(t){return n("el-col",{key:t,attrs:{span:3}},[n("div",{staticClass:"image-small"},[""==e.pushHCVFPImages.body[e.image_count/2+t-1].src?n("i",{staticClass:"el-icon-picture-outline"}):e._e(),""!=e.pushHCVFPImages.body[e.image_count/2+t-1].src?n("img",{staticClass:"image-small",attrs:{src:e.pushHCVFPImages.body[e.image_count/2+t-1].src},on:{click:function(n){return e.look(e.pushHCVFPImages.body[e.image_count/2+t-1])}}}):e._e()])])})),1)],1),n("el-row",{staticClass:"img_list"},[n("el-col",{attrs:{span:2}},[n("div",{staticClass:"type_text"},[e._v("非机动车")])]),n("el-col",{attrs:{span:11}},e._l(e.image_count/2,(function(t){return n("el-col",{key:t,staticClass:"img_col",attrs:{span:3}},[n("div",{staticClass:"image-small"},[""==e.pushHCVFPImages.cycle[t-1].src?n("i",{staticClass:"el-icon-picture-outline"}):e._e(),""!=e.pushHCVFPImages.cycle[t-1].src?n("img",{staticClass:"image-small",attrs:{src:e.pushHCVFPImages.cycle[t-1].src},on:{click:function(n){return e.look(e.pushHCVFPImages.cycle[t-1])}}}):e._e()])])})),1),n("el-col",{attrs:{span:11}},e._l(e.image_count/2,(function(t){return n("el-col",{key:t,staticClass:"img_col",attrs:{span:3}},[n("div",{staticClass:"image-small"},[""==e.pushHCVFPImages.cycle[e.image_count/2+t-1].src?n("i",{staticClass:"el-icon-picture-outline"}):e._e(),""!=e.pushHCVFPImages.cycle[e.image_count/2+t-1].src?n("img",{staticClass:"image-small",attrs:{src:e.pushHCVFPImages.cycle[e.image_count/2+t-1].src},on:{click:function(n){return e.look(e.pushHCVFPImages.cycle[e.image_count/2+t-1])}}}):e._e()])])})),1)],1),n("el-row",{staticClass:"img_list"},[n("el-col",{attrs:{span:2}},[n("div",{staticClass:"type_text"},[e._v("机动车")])]),n("el-col",{attrs:{span:11}},e._l(e.image_count/2,(function(t){return n("el-col",{key:t,attrs:{span:3}},[n("div",{staticClass:"image-small"},[""==e.pushHCVFPImages.vechicle[t-1].src?n("i",{staticClass:"el-icon-picture-outline"}):e._e(),""!=e.pushHCVFPImages.vechicle[t-1].src?n("img",{staticClass:"image-small",attrs:{src:e.pushHCVFPImages.vechicle[t-1].src},on:{click:function(n){return e.look(e.pushHCVFPImages.vechicle[t-1])}}}):e._e()])])})),1),n("el-col",{attrs:{span:11}},e._l(e.image_count/2,(function(t){return n("el-col",{key:t,attrs:{span:3}},[n("div",{staticClass:"image-small"},[""==e.pushHCVFPImages.vechicle[e.image_count/2+t-1].src?n("i",{staticClass:"el-icon-picture-outline"}):e._e(),""!=e.pushHCVFPImages.vechicle[e.image_count/2+t-1].src?n("img",{staticClass:"image-small",attrs:{src:e.pushHCVFPImages.vechicle[e.image_count/2+t-1].src},on:{click:function(n){return e.look(e.pushHCVFPImages.vechicle[e.image_count/2+t-1])}}}):e._e()])])})),1)],1),n("el-row",{staticClass:"img_list_bottom"},[n("el-col",{attrs:{span:2}},[n("div",{staticClass:"type_text"},[e._v("车牌")])]),n("el-col",{attrs:{span:11}},e._l(e.image_count/2,(function(t){return n("el-col",{key:t,attrs:{span:3}},[n("div",{staticClass:"image-small"},[""==e.pushHCVFPImages.plate[t-1].src?n("i",{staticClass:"el-icon-picture-outline"}):e._e(),""!=e.pushHCVFPImages.plate[t-1].src?n("img",{staticClass:"image-small",attrs:{src:e.pushHCVFPImages.plate[t-1].src},on:{click:function(n){return e.look(e.pushHCVFPImages.plate[t-1])}}}):e._e()])])})),1),n("el-col",{attrs:{span:11}},e._l(e.image_count/2,(function(t){return n("el-col",{key:t,attrs:{span:3}},[n("div",{staticClass:"image-small"},[""==e.pushHCVFPImages.plate[e.image_count/2+t-1].src?n("i",{staticClass:"el-icon-picture-outline"}):e._e(),""!=e.pushHCVFPImages.plate[e.image_count/2+t-1].src?n("img",{staticClass:"image-small",attrs:{src:e.pushHCVFPImages.plate[e.image_count/2+t-1].src},on:{click:function(n){return e.look(e.pushHCVFPImages.plate[e.image_count/2+t-1])}}}):e._e()])])})),1)],1)],1),n("el-footer",{directives:[{name:"show",rawName:"v-show",value:"facehuman"==e.detect_mode&&"ai"==e.mode_option,expression:"detect_mode == 'facehuman'  && mode_option == 'ai'"}],staticClass:"fh_img_container"},[n("el-row",{staticClass:"img_list_top"},[n("el-col",{attrs:{span:2}},[n("div",{staticClass:"type_text"},[n("div",{staticClass:"type_text"},[e._v("人脸")])])]),n("el-col",{attrs:{span:11}},e._l(e.image_count/2,(function(t){return n("el-col",{key:t,attrs:{span:3}},[n("div",{staticClass:"image-small"},[""==e.pushFHImages.face[t-1].src?n("i",{staticClass:"el-icon-picture-outline"}):e._e(),""!=e.pushFHImages.face[t-1].src?n("img",{staticClass:"image-small",attrs:{src:e.pushFHImages.face[t-1].src},on:{click:function(n){return e.look(e.pushFHImages.face[t-1])}}}):e._e()])])})),1),n("el-col",{attrs:{span:11}},e._l(e.image_count/2,(function(t){return n("el-col",{key:t,attrs:{span:3}},[n("div",{staticClass:"image-small"},[""==e.pushFHImages.face[e.image_count/2+t-1].src?n("i",{staticClass:"el-icon-picture-outline"}):e._e(),""!=e.pushFHImages.face[e.image_count/2+t-1].src?n("img",{staticClass:"image-small",attrs:{src:e.pushFHImages.face[e.image_count/2+t-1].src},on:{click:function(n){return e.look(e.pushFHImages.face[e.image_count/2+t-1])}}}):e._e()])])})),1)],1),n("el-row",{staticClass:"img_list"},[n("el-col",{attrs:{span:2}},[n("div",{staticClass:"type_text"},[e._v("人脸")])]),n("el-col",{attrs:{span:11}},e._l(e.image_count/2,(function(t){return n("el-col",{key:t,attrs:{span:3}},[n("div",{staticClass:"image-small"},[""==e.pushFHImages.face[e.image_count+t-1].src?n("i",{staticClass:"el-icon-picture-outline"}):e._e(),""!=e.pushFHImages.face[e.image_count+t-1].src?n("img",{staticClass:"image-small",attrs:{src:e.pushFHImages.face[e.image_count+t-1].src},on:{click:function(n){return e.look(e.pushFHImages.face[e.image_count+t-1])}}}):e._e()])])})),1),n("el-col",{attrs:{span:11}},e._l(e.image_count/2,(function(t){return n("el-col",{key:t,attrs:{span:3}},[n("div",{staticClass:"image-small"},[""==e.pushFHImages.face[e.image_count/2+e.image_count+t-1].src?n("i",{staticClass:"el-icon-picture-outline"}):e._e(),""!=e.pushFHImages.face[e.image_count/2+e.image_count+t-1].src?n("img",{staticClass:"image-small",attrs:{src:e.pushFHImages.face[e.image_count/2+e.image_count+t-1].src},on:{click:function(n){return e.look(e.pushFHImages.face[e.image_count/2+e.image_count+t-1])}}}):e._e()])])})),1)],1),n("el-row",{staticClass:"img_list"},[n("el-col",{attrs:{span:2}},[n("div",{staticClass:"type_text"},[e._v("人形")])]),n("el-col",{attrs:{span:11}},e._l(e.image_count/2,(function(t){return n("el-col",{key:t,attrs:{span:3}},[n("div",{staticClass:"image-small"},[""==e.pushFHImages.body[t-1].src?n("i",{staticClass:"el-icon-picture-outline"}):e._e(),""!=e.pushFHImages.body[t-1].src?n("img",{staticClass:"image-small",attrs:{src:e.pushFHImages.body[t-1].src},on:{click:function(n){return e.look(e.pushFHImages.body[t-1])}}}):e._e()])])})),1),n("el-col",{attrs:{span:11}},e._l(e.image_count/2,(function(t){return n("el-col",{key:t,attrs:{span:3}},[n("div",{staticClass:"image-small"},[""==e.pushFHImages.body[e.image_count/2+t-1].src?n("i",{staticClass:"el-icon-picture-outline"}):e._e(),""!=e.pushFHImages.body[e.image_count/2+t-1].src?n("img",{staticClass:"image-small",attrs:{src:e.pushFHImages.body[e.image_count/2+t-1].src},on:{click:function(n){return e.look(e.pushFHImages.body[e.image_count/2+t-1])}}}):e._e()])])})),1)],1),n("el-row",{staticClass:"img_list_bottom"},[n("el-col",{attrs:{span:2}},[n("div",{staticClass:"type_text"},[e._v("人形")])]),n("el-col",{attrs:{span:11}},e._l(e.image_count/2,(function(t){return n("el-col",{key:t,attrs:{span:3}},[n("div",{staticClass:"image-small"},[""==e.pushFHImages.body[e.image_count+t-1].src?n("i",{staticClass:"el-icon-picture-outline"}):e._e(),""!=e.pushFHImages.body[e.image_count+t-1].src?n("img",{staticClass:"image-small",attrs:{src:e.pushFHImages.body[e.image_count+t-1].src},on:{click:function(n){return e.look(e.pushFHImages.body[e.image_count+t-1])}}}):e._e()])])})),1),n("el-col",{attrs:{span:11}},e._l(e.image_count/2,(function(t){return n("el-col",{key:t,attrs:{span:3}},[n("div",{staticClass:"image-small"},[""==e.pushFHImages.body[e.image_count/2+e.image_count+t-1].src?n("i",{staticClass:"el-icon-picture-outline"}):e._e(),""!=e.pushFHImages.body[e.image_count/2+e.image_count+t-1].src?n("img",{staticClass:"image-small",attrs:{src:e.pushFHImages.body[e.image_count/2+e.image_count+t-1].src},on:{click:function(n){return e.look(e.pushFHImages.body[e.image_count/2+e.image_count+t-1])}}}):e._e()])])})),1)],1)],1),n("div",{directives:[{name:"show",rawName:"v-show",value:e.showViewer,expression:"showViewer"}],staticClass:"view_container"},[n("el-dialog",{attrs:{visible:e.showViewer,width:"800px","before-close":e.handleViewerClose},on:{"update:visible":function(t){e.showViewer=t}}},[n("span",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"},[e._v(" "+e._s(e.image_types[e.viewerImg.type]+"详细信息-"+e.viewerImg.date)+" ")]),n("el-row",{staticClass:"view_image_info_container"},[n("el-col",{staticClass:"view_image_col",attrs:{span:12}},[n("el-image",{staticClass:"image-view",attrs:{src:e.viewerImg.src,"preview-src-list":[e.viewerImg.src],fit:"fill"}},[n("div",{staticClass:"image-slot-large",attrs:{slot:"error"},slot:"error"},[n("i",{staticClass:"el-icon-picture-outline"})])])],1),n("el-col",{attrs:{span:12}},[n("div",{staticClass:"view_info_container"},[n("div",{directives:[{name:"show",rawName:"v-show",value:3==e.viewerImg.type&&"facehuman"==e.detect_mode,expression:"viewerImg.type == 3 && detect_mode == 'facehuman'"}],staticClass:"view_info_text"},[e._v(" 性别： "+e._s(e.viewerImg.info.gender)+" ")]),n("div",{directives:[{name:"show",rawName:"v-show",value:3==e.viewerImg.type&&"facehuman"==e.detect_mode,expression:"viewerImg.type == 3 && detect_mode == 'facehuman'"}],staticClass:"view_info_text"},[e._v(" 年龄： "+e._s(e.viewerImg.info.age)+" ")]),n("div",{directives:[{name:"show",rawName:"v-show",value:3==e.viewerImg.type&&"facehuman"==e.detect_mode,expression:"viewerImg.type == 3 && detect_mode == 'facehuman'"}],staticClass:"view_info_text"},[e._v(" 口罩： "+e._s(e.viewerImg.info.mask)+" ")]),n("div",{directives:[{name:"show",rawName:"v-show",value:3==e.viewerImg.type&&"facehuman"==e.detect_mode,expression:"viewerImg.type == 3 && detect_mode == 'facehuman'"}],staticClass:"view_info_text"},[e._v(" 识别： "+e._s(e.viewerImg.info.info)+" ")]),n("div",{directives:[{name:"show",rawName:"v-show",value:4==e.viewerImg.type&&"hvcfp"==e.detect_mode,expression:"viewerImg.type == 4 && detect_mode == 'hvcfp'"}],staticClass:"view_info_text"},[e._v(" 车牌号码："+e._s(e.viewerImg.info.number)+" ")]),n("div",{directives:[{name:"show",rawName:"v-show",value:4==e.viewerImg.type&&"hvcfp"==e.detect_mode,expression:"viewerImg.type == 4 && detect_mode == 'hvcfp'"}],staticClass:"view_info_text"},[e._v(" 车牌颜色："+e._s(e.viewerImg.info.color)+" ")]),n("div",{directives:[{name:"show",rawName:"v-show",value:"facehuman"==e.detect_mode&&3!=e.viewerImg.type||"hvcfp"==e.detect_mode&&4!=e.viewerImg.type,expression:"detect_mode == 'facehuman' && viewerImg.type != 3 || detect_mode == 'hvcfp' && viewerImg.type !=4"}],staticClass:"view_info_text"},[e._v(" 无属性信息 ")])])])],1)],1)],1)],1)],1)},i=[],o=(n(8675),n(3462),n(7380),n(1118),n(3263)),a=n.n(o),s=n(577),c=n.n(s),u=n(3162),l={props:["mode_option"],data(){return{image_count:16,detect_mode:"hvcfp",pushFHImages:{face:[],body:[]},pushHCVFPImages:{face:[],body:[],vechicle:[],cycle:[],plate:[]},currentImg:{type:0,src:"",date:"",info:{age:"--",gender:"--",mask:"--",info:"--",number:"--",color:"--"}},viewerImg:{type:0,src:"",date:"",info:{age:"--",gender:"--",mask:"--",info:"--",number:"--",color:"--"}},eventList:[],image_types:["人形","机动车","非机动车","人脸","车牌"],sizeOptions:[{id:0,label:"自适应",value:"0:0",icon:"el-icon-full-screen"},{id:1,label:"原比例",value:"1:1",icon:"el-icon-full-screen"}],srcOptions:[{id:0,label:"视频源0",icon:"el-icon-full-screen"},{id:1,label:"视频源1",icon:"el-icon-full-screen"}],streamOptions:[{id:0,label:"主码流0",icon:"el-icon-full-screen"},{id:1,label:"子码流1",icon:"el-icon-full-screen"}],genderOptions:["女","男"],respiratorOptions:{no_respirator:"未戴口罩",surgical:"医用口罩","anti-pollution":"防雾霾口罩",common:"普通口罩",kitchen_transparent:"厨房透明口罩",unknown:"未知"},plateColorOptions:{blue:"蓝色",yellow:"黄色",black:"黑色",white:"白色",green:"绿色",small_new_energy:"新能源",large_new_energy:"新能源",absence:"未知",unknown:"未知"},screenIcon:"vjs-icon-fullscreen-enter",sizeOptionInd:0,srcOptionInd:0,streamOptionInd:1,rec_enable:!0,isAiEnable:!1,isSearchImg:!1,isFullScreen:!1,isRecStart:!1,isError:!1,wfsObj:null,isForceStop:!1,wsCapture:[null,null],wsEvents:null,timer_capture:[void 0,void 0],timerEvents:void 0,lastRecvDataTime:[0,0],curImgInd:{fh:[0,0],hcvfp:[0,0,0,0,0]},max_try_num:3,showViewer:!1,timerTest:null,curInd:0,curListInd:0}},created(){console.log("preview created ++"),this.getInfo();var e=window.localStorage.getItem("stream");this.streamOptionInd="0"===e?0:"1"===e?1:"2"===e?2:1,e=window.localStorage.getItem("src_id"),this.srcOptionInd="1"===e?1:0,e=window.localStorage.getItem("size"),this.sizeOptionInd="1"===e?1:0;for(var t=0;t<this.image_count;t++)this.pushFHImages.face.push({type:3,src:"",date:"",info:{gender:"--",age:"--",mask:"--",info:"--"}}),this.pushFHImages.face.push({type:3,src:"",date:"",info:{gender:"--",age:"--",mask:"--",info:"--"}}),this.pushFHImages.body.push({type:0,src:"",date:"",info:{}}),this.pushFHImages.body.push({type:0,src:"",date:"",info:{}}),this.pushHCVFPImages.face.push({type:3,src:"",date:"",info:{}}),this.pushHCVFPImages.body.push({type:0,src:"",date:"",info:{}}),this.pushHCVFPImages.vechicle.push({type:1,src:"",date:"",info:{}}),this.pushHCVFPImages.cycle.push({type:2,src:"",date:"",info:{}}),this.pushHCVFPImages.plate.push({type:4,src:"",date:"",info:{number:"--",color:"--"}});if(!document.getElementById("converterScript")){let e=document.createElement("script");e.setAttribute("src","js/wasmconverter.js"),e.setAttribute("type","text/javascript"),e.setAttribute("id","converterScript"),document.head.appendChild(e)}console.log("preview created --")},mounted(){console.log("preview mounted ++");const e=this;c().isEnabled&&c().on("change",(()=>{e.checkFull()})),this.startMedia(),document.addEventListener("visibilitychange",(()=>{this.wfsObj&&this.wfsObj.playerSeekNow()})),console.log("preview mounted --")},destroyed(){this.stopMedia()},methods:{wasmConvertImage(e){const t=0,n=1;var r=Module.convertImage(e,e.length,t,n);return r},startMedia(){this.startPlay(),this.startCapture(0),this.startCapture(1),this.startRecvEvents()},stopMedia(){this.isForceStop=!0,this.stop(),this.stopCatpure(0),this.stopCatpure(1),this.stopRecvEvents(),c().off("change",(()=>{}))},startPreview(){this.startPlay(),this.startCapture(0),this.startCapture(1)},stopPreview(){this.isForceStop=!0,this.stop(),this.stopCatpure(0),this.stopCatpure(1)},async startPlay(){for(var e=!1,t=0;t<this.max_try_num;t++){if(e)break;try{await this.changeStream(this.streamOptionInd+"",!1,!1),this.play(),e=!0}catch(n){e=!1,t==this.max_try_num-1&&console.log("startPlay catch except: "+n)}}e||this.$message.error("网络请求码流失败")},play(){console.log("play ++");try{this.stop(),this.changeSizeOption(this.sizeOptionInd+"");const e=window.sessionStorage.getItem("token"),t=document.getElementById("myVideo");let n=t,r="H264Raw";if(a().isSupported()){let t={wsMinPacketInterval:2e3,wsMaxPacketInterval:8e3};this.wfsObj=new(a())(t),this.wfsObj.attachMedia(n,"ch1",r,"ws/preview?token="+e),this.wfsObj.on(a().Events.ERROR,((e,t)=>this.handleWfsEvent(e,t))),this.isRecStart&&(this.isRecStart=!1,this.onRecording())}else console.log("wfs is not supported")}catch(e){console.log("play catch except: "+e)}console.log("play --")},stop(){console.log("stop ++"),null!=this.wfsObj&&(this.isRecStart&&(this.wfsObj.stop_recording(),this.isError||(this.isRecStart=!1)),this.wfsObj.destroy(),this.wfsObj=null),console.log("stop --")},changeSizeOption(e){this.sizeOptionInd=Number(e),0===this.sizeOptionInd?document.getElementById("myVideo").style.setProperty("object-fit","fill","important"):document.getElementById("myVideo").style.setProperty("object-fit","contain","important"),console.log("old objectFit: ",document.getElementById("myVideo").style.objectFit),window.localStorage.setItem("size",this.sizeOptionInd)},async changeStream(e,t=!0,n=!0){const r=Number(e);console.log("change stream to "+this.streamOptions[r].id);const{data:i}=await this.$http.post("preview/stream",{src:this.srcOptions[this.srcOptionInd].id,stream:this.streamOptions[r].id});if(console.log("post stream return: ",i),!i||200!==i.meta.status)return this.$message.error("设置码流失败");n&&(this.streamOptionInd=r,window.localStorage.setItem("src_id",this.srcOptions[this.srcOptionInd].id),window.localStorage.setItem("stream",this.streamOptions[r].id)),t&&this.play()},async recordFaceinfo(){console.log("record faceinfo"),this.stop();const{data:e}=await this.$http.post("preview/faceinfo",{faceinfo:!0});return this.play(),console.log("post record faceinfo: ",e),200!==e.meta.status?this.$message.error("人像信息录入失败"):0==e.data.faceinfo.status?this.$message.success("人像信息录入成功"):2==e.data.faceinfo.status?this.$message.warning("不支持此功能"):3==e.data.faceinfo.status?this.$message.warning("数据加载中，请稍后再试"):this.$message.error("人像信息录入失败，请重试")},async getInfo(){try{const{data:e}=await this.$http.get("preview/info");console.log("preview info get return: ",e),200===e.meta.status&&(this.isSearchImg=e.data.info.searchimg,this.isAiEnable=e.data.info.ai_enable,this.detect_mode=e.data.info.detect_mode,console.log("detect_mode: "+this.detect_mode),this.detect_mode||(this.detect_mode="facehuman",console.log("set detect_mode to default: "+this.detect_mode)))}catch(e){this.$message.error("获取信息失败")}},rec_result_cb(e){this.rec_enable=!0,e?this.isRecStart=!0:this.$message.error("开启录像失败")},rec_state_cb(e){this.rec_enable=e},async onSnapshot(){try{const{data:e}=await this.$http.get("preview/snapshot");200===e.meta.status&&console.log("send snapshot cmd succ")}catch(e){this.$message.error("发送命令失败")}},async onRecording(){if(this.wfsObj)if(this.isRecStart)this.wfsObj.stop_recording(),this.isRecStart=!1;else{this.rec_enable=!1;var e=window.localStorage.getItem("rec_threshold_web");void 0==e&&(e=1024),console.log("recording - threshold: "+e+" MB"),this.wfsObj.start_recording(1024*e*1024,this.rec_result_cb,this.rec_state_cb)}},doScreen(){const e=document.getElementsByClassName("preview_container")[0];this.isFullScreen?(c().exit(e),this.screenIcon="vjs-icon-fullscreen-enter"):(c().request(e),this.screenIcon="vjs-icon-fullscreen-exit"),this.isFullScreen=!this.isFullScreen},checkFull(){c().isFullscreen||(this.isFullScreen=!1,this.screenIcon="vjs-icon-fullscreen-enter")},scaleVideoTo16vs9(){var e=document.getElementById("myVideo");console.log("videoRatio:"+e.videoWidth+"/"+e.videoHeight)},handleWfsEvent(e,t){try{if(t.fatal){switch(this.isError=!0,console.warn("Fatal error :"+t.details),t.type){case a().ErrorTypes.MEDIA_ERROR:console.log("a media error occurred");break;case a().ErrorTypes.NETWORK_ERROR:console.log("a network error occurred");break;default:console.log("an unrecoverable error occurred");break}this.play()}}catch(n){console.log("handleWfsEvent catch except: "+n.description)}},startCapture(e){this.stopCatpure(e);const t=window.sessionStorage.getItem("token");var n="ws://"+window.location.host+"/ws/capture_"+e+"?token="+t,r="binary";this.wsCapture[e]=new WebSocket(n,r),this.wsCapture[e].onopen=()=>{console.log("ws_"+e+" capture connected"),this.create_capture_timer(e)},this.wsCapture[e].onclose=t=>{console.log("ws_"+e+" capture disconnected",t),this.isForceStop||this.startCapture(e)},this.wsCapture[e].onmessage=t=>{if("string"===typeof t.data)console.log("got a wscapture message: "+t.data);else try{if(this.lastRecvDataTime[e]=performance.now(),0===e){var n=new FileReader;n.onload=e=>{e.target.readyState===FileReader.DONE&&this.parseJpgDataWithHead(e.target.result)},n.readAsArrayBuffer(t.data)}else if(1===e){const e=new Blob([t.data],{type:"image/jpeg"}),n="snapshot_"+this.getCurrentTime()+".jpg";(0,u.saveAs)(e,n)}}catch(r){console.log("capture image catch except: "+r)}},this.wsCapture[e].onerror=t=>{console.log("ws_"+e+" capture occure error",t)}},stopCatpure(e){this.clear_capture_timer(e),this.wsCapture[e]&&this.wsCapture[e].close()},create_capture_timer(e){this.clear_capture_timer(e),this.timer_capture[e]=setInterval((()=>{this.wsCapture[e]&&this.wsCapture[e].send("keep-alive")}),3e3)},clear_capture_timer(e){this.timer_capture[e]&&(clearInterval(this.timer_capture[e]),this.timer_capture[e]=void 0)},startRecvEvents(){console.log("startRecvEvents ++"),this.stopRecvEvents();const e=window.sessionStorage.getItem("token");var t="ws://"+window.location.host+"/ws/events?token="+e,n="binary";this.wsEvents=new WebSocket(t,n),this.wsEvents.onopen=()=>{console.log("ws events connected"),this.createEventstimer()},this.wsEvents.onclose=e=>{console.log("ws events disconnected",e),this.isForceStop||this.startRecvEvents()},this.wsEvents.onmessage=e=>{if("string"===typeof e.data)console.log("got a ws events message: "+e.data);else try{var t=new FileReader;t.onload=e=>{if(e.target.readyState===FileReader.DONE){console.log("got a event: "+e.target.result);for(var t=JSON.parse(e.target.result),n=0;n<t.events.length;n++)1===t.events[n].type?this.eventList.unshift({type:"移动",date:t.events[n].date}):2===t.events[n].type?this.eventList.unshift({type:"遮挡",date:t.events[n].date}):0===t.events[n].type&&(this.stopPreview(),this.startPreview());this.eventList.length>32&&this.eventList.splice(32,this.eventList.length-32)}},t.readAsText(e.data)}catch(n){console.log("ws events catch except: "+n)}},this.wsEvents.onerror=e=>{console.log("ws events occure error",e)},console.log("startRecvEvents --")},stopRecvEvents(){console.log("stopRecvEvents ++"),this.clearEventstimer(),this.wsEvents&&this.wsEvents.close(),console.log("stopRecvEvents --")},createEventstimer(){this.clearEventstimer(),this.timerEvents=setInterval((()=>{this.wsEvents&&this.wsEvents.send("keep-alive")}),3e3)},clearEventstimer(){this.timerEvents&&(clearInterval(this.timerEvents),this.timerEvents=void 0)},parseJpgDataWithHead(e){try{var t=new Uint8Array(e.slice(0,16));if(t&&65===t[0]&&88===t[1]&&73===t[2]&&84===t[3]){var n=this.bytesToIntLittleEndian(t.subarray(4,8));if(74===t[8]&&83===t[9]&&79===t[10]&&78===t[11]){var r=this.bytesToIntLittleEndian(t.subarray(12,16)),i=new TextDecoder("utf-8"),o=new Uint8Array(e.slice(16,16+r-1)),a=i.decode(o);console.log("jpg info:"+a);var s=JSON.parse(a),c=e.slice(n),u=this.wasmConvertImage(new Uint8Array(c)),l=btoa(new Uint8Array(u).reduce(((e,t)=>e+String.fromCharCode(t)),"")),f="data:image/png;base64,"+l;if(s&&f)if("facehuman"===this.detect_mode){if(3===s.type){var d=this.curImgInd.fh[0];this.pushFHImages.face[d].src=f,this.pushFHImages.face[d].date=this.getCurrentTime(),this.pushFHImages.face[d].info.gender=this.genderOptions[s.attribute.face.gender],this.pushFHImages.face[d].info.age=s.attribute.face.age,this.pushFHImages.face[d].info.mask=this.respiratorOptions[s.attribute.face.mask],this.pushFHImages.face[d].info.info=s.attribute.face.info,this.curImgInd.fh[0]=(d+1)%this.pushFHImages.face.length,this.currentImg.src=f,this.currentImg.type=3,this.currentImg.date=this.pushFHImages.face[d].date,this.currentImg.info.gender=this.pushFHImages.face[d].info.gender,this.currentImg.info.age=this.pushFHImages.face[d].info.age,this.currentImg.info.mask=this.pushFHImages.face[d].info.mask,this.currentImg.info.info=this.pushFHImages.face[d].info.info}else if(0===s.type){d=this.curImgInd.fh[1];this.pushFHImages.body[d].src=f,this.pushFHImages.body[d].date=this.getCurrentTime(),this.pushFHImages.face[d].info={},this.curImgInd.fh[1]=(d+1)%this.pushFHImages.body.length}}else if(3===s.type){d=this.curImgInd.hcvfp[0];this.pushHCVFPImages.face[d].src=f,this.pushHCVFPImages.face[d].date=this.getCurrentTime(),this.pushHCVFPImages.face[d].info={},this.curImgInd.hcvfp[0]=(d+1)%this.pushHCVFPImages.face.length}else if(0===s.type){d=this.curImgInd.hcvfp[1];this.pushHCVFPImages.body[d].src=f,this.pushHCVFPImages.body[d].date=this.getCurrentTime(),this.pushHCVFPImages.body[d].info={},this.curImgInd.hcvfp[1]=(d+1)%this.pushHCVFPImages.body.length}else if(1===s.type){d=this.curImgInd.hcvfp[2];this.pushHCVFPImages.vechicle[d].src=f,this.pushHCVFPImages.vechicle[d].date=this.getCurrentTime(),this.pushHCVFPImages.vechicle[d].info={},this.curImgInd.hcvfp[2]=(d+1)%this.pushHCVFPImages.vechicle.length}else if(2===s.type){d=this.curImgInd.hcvfp[3];this.pushHCVFPImages.cycle[d].src=f,this.pushHCVFPImages.cycle[d].date=this.getCurrentTime(),this.pushHCVFPImages.cycle[d].info={},this.curImgInd.hcvfp[3]=(d+1)%this.pushHCVFPImages.cycle.length}else if(4===s.type){d=this.curImgInd.hcvfp[4];this.pushHCVFPImages.plate[d].src=f,this.pushHCVFPImages.plate[d].date=this.getCurrentTime(),this.pushHCVFPImages.plate[d].info.number=s.attribute.plate.num,this.pushHCVFPImages.plate[d].info.color=this.plateColorOptions[s.attribute.plate.color],this.curImgInd.hcvfp[4]=(d+1)%this.pushHCVFPImages.plate.length,this.currentImg.src=f,this.currentImg.type=4,this.currentImg.date=this.pushHCVFPImages.plate[d].date,this.currentImg.info.number=this.pushHCVFPImages.plate[d].info.number,this.currentImg.info.color=this.pushHCVFPImages.plate[d].info.color}}}}catch(h){console.log("ws parse jpg with header catch except: "+h)}},getCurrentTime(){var e=new Date,t=this.zeroFill(e.getMonth()+1),n=this.zeroFill(e.getDate()),r=this.zeroFill(e.getHours()),i=this.zeroFill(e.getMinutes()),o=this.zeroFill(e.getSeconds()),a=e.getMilliseconds();a<=9?a="00"+a:a<=99&&(a="0"+a);var s=e.getFullYear()+"-"+t+"-"+n+" "+r+":"+i+":"+o+"."+a;return s},zeroFill(e){return e>=0&&e<=9?"0"+e:e},bytesToIntLittleEndian(e){for(var t=0,n=e.length-1;n>=0;n--)t+=e[n],0!=n&&(t<<=8);return t},handleViewerClose(){this.showViewer=!1},look(e){("facehuman"===this.detect_mode&&3===e.type||"hvcfp"===this.detect_mode&&4===e.type)&&(this.currentImg.type=e.type,this.currentImg.src=e.src,this.currentImg.date=e.date,this.currentImg.info.age=e.info.age,this.currentImg.info.gender=e.info.gender,this.currentImg.info.mask=e.info.mask,this.currentImg.info.info=e.info.info,this.currentImg.info.number=e.info.number,this.currentImg.info.color=e.info.color),this.viewerImg.type=e.type,this.viewerImg.src=e.src,this.viewerImg.date=e.date,this.viewerImg.info.age=e.info.age,this.viewerImg.info.gender=e.info.gender,this.viewerImg.info.mask=e.info.mask,this.viewerImg.info.info=e.info.info,this.viewerImg.info.number=e.info.number,this.viewerImg.info.color=e.info.color,this.showViewer=!0}}},f=l,d=n(3736),h=(0,d.Z)(f,r,i,!1,null,"30a0c8c1",null),p=h.exports},9662:function(e,t,n){var r=n(7854),i=n(614),o=n(6330),a=r.TypeError;e.exports=function(e){if(i(e))return e;throw a(o(e)+" is not a function")}},6077:function(e,t,n){var r=n(7854),i=n(614),o=r.String,a=r.TypeError;e.exports=function(e){if("object"==typeof e||i(e))return e;throw a("Can't set "+o(e)+" as a prototype")}},1223:function(e,t,n){var r=n(5112),i=n(30),o=n(3070),a=r("unscopables"),s=Array.prototype;void 0==s[a]&&o.f(s,a,{configurable:!0,value:i(null)}),e.exports=function(e){s[a][e]=!0}},9670:function(e,t,n){var r=n(7854),i=n(111),o=r.String,a=r.TypeError;e.exports=function(e){if(i(e))return e;throw a(o(e)+" is not an object")}},4019:function(e){e.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},260:function(e,t,n){"use strict";var r,i,o,a=n(4019),s=n(9781),c=n(7854),u=n(614),l=n(111),f=n(2597),d=n(648),h=n(6330),p=n(8880),m=n(1320),v=n(3070).f,g=n(7976),y=n(9518),b=n(7674),w=n(5112),_=n(9711),E=c.Int8Array,k=E&&E.prototype,A=c.Uint8ClampedArray,I=A&&A.prototype,S=E&&y(E),T=k&&y(k),C=Object.prototype,O=c.TypeError,R=w("toStringTag"),x=_("TYPED_ARRAY_TAG"),P=_("TYPED_ARRAY_CONSTRUCTOR"),F=a&&!!b&&"Opera"!==d(c.opera),L=!1,D={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},j={BigInt64Array:8,BigUint64Array:8},H=function(e){if(!l(e))return!1;var t=d(e);return"DataView"===t||f(D,t)||f(j,t)},M=function(e){if(!l(e))return!1;var t=d(e);return f(D,t)||f(j,t)},N=function(e){if(M(e))return e;throw O("Target is not a typed array")},U=function(e){if(u(e)&&(!b||g(S,e)))return e;throw O(h(e)+" is not a typed array constructor")},B=function(e,t,n){if(s){if(n)for(var r in D){var i=c[r];if(i&&f(i.prototype,e))try{delete i.prototype[e]}catch(o){}}T[e]&&!n||m(T,e,n?t:F&&k[e]||t)}},V=function(e,t,n){var r,i;if(s){if(b){if(n)for(r in D)if(i=c[r],i&&f(i,e))try{delete i[e]}catch(o){}if(S[e]&&!n)return;try{return m(S,e,n?t:F&&S[e]||t)}catch(o){}}for(r in D)i=c[r],!i||i[e]&&!n||m(i,e,t)}};for(r in D)i=c[r],o=i&&i.prototype,o?p(o,P,i):F=!1;for(r in j)i=c[r],o=i&&i.prototype,o&&p(o,P,i);if((!F||!u(S)||S===Function.prototype)&&(S=function(){throw O("Incorrect invocation")},F))for(r in D)c[r]&&b(c[r],S);if((!F||!T||T===C)&&(T=S.prototype,F))for(r in D)c[r]&&b(c[r].prototype,T);if(F&&y(I)!==T&&b(I,T),s&&!f(T,R))for(r in L=!0,v(T,R,{get:function(){return l(this)?this[x]:void 0}}),D)c[r]&&p(c[r],x,r);e.exports={NATIVE_ARRAY_BUFFER_VIEWS:F,TYPED_ARRAY_CONSTRUCTOR:P,TYPED_ARRAY_TAG:L&&x,aTypedArray:N,aTypedArrayConstructor:U,exportTypedArrayMethod:B,exportTypedArrayStaticMethod:V,isView:H,isTypedArray:M,TypedArray:S,TypedArrayPrototype:T}},1318:function(e,t,n){var r=n(5656),i=n(1400),o=n(6244),a=function(e){return function(t,n,a){var s,c=r(t),u=o(c),l=i(a,u);if(e&&n!=n){while(u>l)if(s=c[l++],s!=s)return!0}else for(;u>l;l++)if((e||l in c)&&c[l]===n)return e||l||0;return!e&&-1}};e.exports={includes:a(!0),indexOf:a(!1)}},9671:function(e,t,n){var r=n(9974),i=n(8361),o=n(7908),a=n(6244),s=function(e){var t=1==e;return function(n,s,c){var u,l,f=o(n),d=i(f),h=r(s,c),p=a(d);while(p-- >0)if(u=d[p],l=h(u,p,f),l)switch(e){case 0:return u;case 1:return p}return t?-1:void 0}};e.exports={findLast:s(0),findLastIndex:s(1)}},4326:function(e,t,n){var r=n(1702),i=r({}.toString),o=r("".slice);e.exports=function(e){return o(i(e),8,-1)}},648:function(e,t,n){var r=n(7854),i=n(1694),o=n(614),a=n(4326),s=n(5112),c=s("toStringTag"),u=r.Object,l="Arguments"==a(function(){return arguments}()),f=function(e,t){try{return e[t]}catch(n){}};e.exports=i?a:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=f(t=u(e),c))?n:l?a(t):"Object"==(r=a(t))&&o(t.callee)?"Arguments":r}},2128:function(e,t,n){var r=n(2597),i=n(3887),o=n(1236),a=n(3070);e.exports=function(e,t){for(var n=i(t),s=a.f,c=o.f,u=0;u<n.length;u++){var l=n[u];r(e,l)||s(e,l,c(t,l))}}},9920:function(e,t,n){var r=n(7293);e.exports=!r((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},8880:function(e,t,n){var r=n(9781),i=n(3070),o=n(9114);e.exports=r?function(e,t,n){return i.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},9114:function(e){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},9781:function(e,t,n){var r=n(7293);e.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},317:function(e,t,n){var r=n(7854),i=n(111),o=r.document,a=i(o)&&i(o.createElement);e.exports=function(e){return a?o.createElement(e):{}}},8113:function(e,t,n){var r=n(5005);e.exports=r("navigator","userAgent")||""},7392:function(e,t,n){var r,i,o=n(7854),a=n(8113),s=o.process,c=o.Deno,u=s&&s.versions||c&&c.version,l=u&&u.v8;l&&(r=l.split("."),i=r[0]>0&&r[0]<4?1:+(r[0]+r[1])),!i&&a&&(r=a.match(/Edge\/(\d+)/),(!r||r[1]>=74)&&(r=a.match(/Chrome\/(\d+)/),r&&(i=+r[1]))),e.exports=i},748:function(e){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},2109:function(e,t,n){var r=n(7854),i=n(1236).f,o=n(8880),a=n(1320),s=n(3505),c=n(2128),u=n(4705);e.exports=function(e,t){var n,l,f,d,h,p,m=e.target,v=e.global,g=e.stat;if(l=v?r:g?r[m]||s(m,{}):(r[m]||{}).prototype,l)for(f in t){if(h=t[f],e.noTargetGet?(p=i(l,f),d=p&&p.value):d=l[f],n=u(v?f:m+(g?".":"#")+f,e.forced),!n&&void 0!==d){if(typeof h==typeof d)continue;c(h,d)}(e.sham||d&&d.sham)&&o(h,"sham",!0),a(l,f,h,e)}}},7293:function(e){e.exports=function(e){try{return!!e()}catch(t){return!0}}},9974:function(e,t,n){var r=n(1702),i=n(9662),o=r(r.bind);e.exports=function(e,t){return i(e),void 0===t?e:o?o(e,t):function(){return e.apply(t,arguments)}}},6916:function(e){var t=Function.prototype.call;e.exports=t.bind?t.bind(t):function(){return t.apply(t,arguments)}},6530:function(e,t,n){var r=n(9781),i=n(2597),o=Function.prototype,a=r&&Object.getOwnPropertyDescriptor,s=i(o,"name"),c=s&&"something"===function(){}.name,u=s&&(!r||r&&a(o,"name").configurable);e.exports={EXISTS:s,PROPER:c,CONFIGURABLE:u}},1702:function(e){var t=Function.prototype,n=t.bind,r=t.call,i=n&&n.bind(r);e.exports=n?function(e){return e&&i(r,e)}:function(e){return e&&function(){return r.apply(e,arguments)}}},5005:function(e,t,n){var r=n(7854),i=n(614),o=function(e){return i(e)?e:void 0};e.exports=function(e,t){return arguments.length<2?o(r[e]):r[e]&&r[e][t]}},8173:function(e,t,n){var r=n(9662);e.exports=function(e,t){var n=e[t];return null==n?void 0:r(n)}},7854:function(e,t,n){var r=function(e){return e&&e.Math==Math&&e};e.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||function(){return this}()||Function("return this")()},2597:function(e,t,n){var r=n(1702),i=n(7908),o=r({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return o(i(e),t)}},3501:function(e){e.exports={}},490:function(e,t,n){var r=n(5005);e.exports=r("document","documentElement")},4664:function(e,t,n){var r=n(9781),i=n(7293),o=n(317);e.exports=!r&&!i((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},8361:function(e,t,n){var r=n(7854),i=n(1702),o=n(7293),a=n(4326),s=r.Object,c=i("".split);e.exports=o((function(){return!s("z").propertyIsEnumerable(0)}))?function(e){return"String"==a(e)?c(e,""):s(e)}:s},2788:function(e,t,n){var r=n(1702),i=n(614),o=n(5465),a=r(Function.toString);i(o.inspectSource)||(o.inspectSource=function(e){return a(e)}),e.exports=o.inspectSource},9909:function(e,t,n){var r,i,o,a=n(8536),s=n(7854),c=n(1702),u=n(111),l=n(8880),f=n(2597),d=n(5465),h=n(6200),p=n(3501),m="Object already initialized",v=s.TypeError,g=s.WeakMap,y=function(e){return o(e)?i(e):r(e,{})},b=function(e){return function(t){var n;if(!u(t)||(n=i(t)).type!==e)throw v("Incompatible receiver, "+e+" required");return n}};if(a||d.state){var w=d.state||(d.state=new g),_=c(w.get),E=c(w.has),k=c(w.set);r=function(e,t){if(E(w,e))throw new v(m);return t.facade=e,k(w,e,t),t},i=function(e){return _(w,e)||{}},o=function(e){return E(w,e)}}else{var A=h("state");p[A]=!0,r=function(e,t){if(f(e,A))throw new v(m);return t.facade=e,l(e,A,t),t},i=function(e){return f(e,A)?e[A]:{}},o=function(e){return f(e,A)}}e.exports={set:r,get:i,has:o,enforce:y,getterFor:b}},614:function(e){e.exports=function(e){return"function"==typeof e}},4705:function(e,t,n){var r=n(7293),i=n(614),o=/#|\.prototype\./,a=function(e,t){var n=c[s(e)];return n==l||n!=u&&(i(t)?r(t):!!t)},s=a.normalize=function(e){return String(e).replace(o,".").toLowerCase()},c=a.data={},u=a.NATIVE="N",l=a.POLYFILL="P";e.exports=a},111:function(e,t,n){var r=n(614);e.exports=function(e){return"object"==typeof e?null!==e:r(e)}},1913:function(e){e.exports=!1},2190:function(e,t,n){var r=n(7854),i=n(5005),o=n(614),a=n(7976),s=n(3307),c=r.Object;e.exports=s?function(e){return"symbol"==typeof e}:function(e){var t=i("Symbol");return o(t)&&a(t.prototype,c(e))}},6244:function(e,t,n){var r=n(7466);e.exports=function(e){return r(e.length)}},133:function(e,t,n){var r=n(7392),i=n(7293);e.exports=!!Object.getOwnPropertySymbols&&!i((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},8536:function(e,t,n){var r=n(7854),i=n(614),o=n(2788),a=r.WeakMap;e.exports=i(a)&&/native code/.test(o(a))},30:function(e,t,n){var r,i=n(9670),o=n(6048),a=n(748),s=n(3501),c=n(490),u=n(317),l=n(6200),f=">",d="<",h="prototype",p="script",m=l("IE_PROTO"),v=function(){},g=function(e){return d+p+f+e+d+"/"+p+f},y=function(e){e.write(g("")),e.close();var t=e.parentWindow.Object;return e=null,t},b=function(){var e,t=u("iframe"),n="java"+p+":";return t.style.display="none",c.appendChild(t),t.src=String(n),e=t.contentWindow.document,e.open(),e.write(g("document.F=Object")),e.close(),e.F},w=function(){try{r=new ActiveXObject("htmlfile")}catch(t){}w="undefined"!=typeof document?document.domain&&r?y(r):b():y(r);var e=a.length;while(e--)delete w[h][a[e]];return w()};s[m]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(v[h]=i(e),n=new v,v[h]=null,n[m]=e):n=w(),void 0===t?n:o(n,t)}},6048:function(e,t,n){var r=n(9781),i=n(3070),o=n(9670),a=n(5656),s=n(1956);e.exports=r?Object.defineProperties:function(e,t){o(e);var n,r=a(t),c=s(t),u=c.length,l=0;while(u>l)i.f(e,n=c[l++],r[n]);return e}},3070:function(e,t,n){var r=n(7854),i=n(9781),o=n(4664),a=n(9670),s=n(4948),c=r.TypeError,u=Object.defineProperty;t.f=i?u:function(e,t,n){if(a(e),t=s(t),a(n),o)try{return u(e,t,n)}catch(r){}if("get"in n||"set"in n)throw c("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},1236:function(e,t,n){var r=n(9781),i=n(6916),o=n(5296),a=n(9114),s=n(5656),c=n(4948),u=n(2597),l=n(4664),f=Object.getOwnPropertyDescriptor;t.f=r?f:function(e,t){if(e=s(e),t=c(t),l)try{return f(e,t)}catch(n){}if(u(e,t))return a(!i(o.f,e,t),e[t])}},8006:function(e,t,n){var r=n(6324),i=n(748),o=i.concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,o)}},5181:function(e,t){t.f=Object.getOwnPropertySymbols},9518:function(e,t,n){var r=n(7854),i=n(2597),o=n(614),a=n(7908),s=n(6200),c=n(9920),u=s("IE_PROTO"),l=r.Object,f=l.prototype;e.exports=c?l.getPrototypeOf:function(e){var t=a(e);if(i(t,u))return t[u];var n=t.constructor;return o(n)&&t instanceof n?n.prototype:t instanceof l?f:null}},7976:function(e,t,n){var r=n(1702);e.exports=r({}.isPrototypeOf)},6324:function(e,t,n){var r=n(1702),i=n(2597),o=n(5656),a=n(1318).indexOf,s=n(3501),c=r([].push);e.exports=function(e,t){var n,r=o(e),u=0,l=[];for(n in r)!i(s,n)&&i(r,n)&&c(l,n);while(t.length>u)i(r,n=t[u++])&&(~a(l,n)||c(l,n));return l}},1956:function(e,t,n){var r=n(6324),i=n(748);e.exports=Object.keys||function(e){return r(e,i)}},5296:function(e,t){"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,i=r&&!n.call({1:2},1);t.f=i?function(e){var t=r(this,e);return!!t&&t.enumerable}:n},7674:function(e,t,n){var r=n(1702),i=n(9670),o=n(6077);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{e=r(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set),e(n,[]),t=n instanceof Array}catch(a){}return function(n,r){return i(n),o(r),t?e(n,r):n.__proto__=r,n}}():void 0)},2140:function(e,t,n){var r=n(7854),i=n(6916),o=n(614),a=n(111),s=r.TypeError;e.exports=function(e,t){var n,r;if("string"===t&&o(n=e.toString)&&!a(r=i(n,e)))return r;if(o(n=e.valueOf)&&!a(r=i(n,e)))return r;if("string"!==t&&o(n=e.toString)&&!a(r=i(n,e)))return r;throw s("Can't convert object to primitive value")}},3887:function(e,t,n){var r=n(5005),i=n(1702),o=n(8006),a=n(5181),s=n(9670),c=i([].concat);e.exports=r("Reflect","ownKeys")||function(e){var t=o.f(s(e)),n=a.f;return n?c(t,n(e)):t}},1320:function(e,t,n){var r=n(7854),i=n(614),o=n(2597),a=n(8880),s=n(3505),c=n(2788),u=n(9909),l=n(6530).CONFIGURABLE,f=u.get,d=u.enforce,h=String(String).split("String");(e.exports=function(e,t,n,c){var u,f=!!c&&!!c.unsafe,p=!!c&&!!c.enumerable,m=!!c&&!!c.noTargetGet,v=c&&void 0!==c.name?c.name:t;i(n)&&("Symbol("===String(v).slice(0,7)&&(v="["+String(v).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!o(n,"name")||l&&n.name!==v)&&a(n,"name",v),u=d(n),u.source||(u.source=h.join("string"==typeof v?v:""))),e!==r?(f?!m&&e[t]&&(p=!0):delete e[t],p?e[t]=n:a(e,t,n)):p?e[t]=n:s(t,n)})(Function.prototype,"toString",(function(){return i(this)&&f(this).source||c(this)}))},7066:function(e,t,n){"use strict";var r=n(9670);e.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},4488:function(e,t,n){var r=n(7854),i=r.TypeError;e.exports=function(e){if(void 0==e)throw i("Can't call method on "+e);return e}},3505:function(e,t,n){var r=n(7854),i=Object.defineProperty;e.exports=function(e,t){try{i(r,e,{value:t,configurable:!0,writable:!0})}catch(n){r[e]=t}return t}},6200:function(e,t,n){var r=n(2309),i=n(9711),o=r("keys");e.exports=function(e){return o[e]||(o[e]=i(e))}},5465:function(e,t,n){var r=n(7854),i=n(3505),o="__core-js_shared__",a=r[o]||i(o,{});e.exports=a},2309:function(e,t,n){var r=n(1913),i=n(5465);(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.19.3",mode:r?"pure":"global",copyright:"© 2021 Denis Pushkarev (zloirock.ru)"})},1400:function(e,t,n){var r=n(9303),i=Math.max,o=Math.min;e.exports=function(e,t){var n=r(e);return n<0?i(n+t,0):o(n,t)}},5656:function(e,t,n){var r=n(8361),i=n(4488);e.exports=function(e){return r(i(e))}},9303:function(e){var t=Math.ceil,n=Math.floor;e.exports=function(e){var r=+e;return r!==r||0===r?0:(r>0?n:t)(r)}},7466:function(e,t,n){var r=n(9303),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},7908:function(e,t,n){var r=n(7854),i=n(4488),o=r.Object;e.exports=function(e){return o(i(e))}},4590:function(e,t,n){var r=n(7854),i=n(3002),o=r.RangeError;e.exports=function(e,t){var n=i(e);if(n%t)throw o("Wrong offset");return n}},3002:function(e,t,n){var r=n(7854),i=n(9303),o=r.RangeError;e.exports=function(e){var t=i(e);if(t<0)throw o("The argument can't be less than 0");return t}},7593:function(e,t,n){var r=n(7854),i=n(6916),o=n(111),a=n(2190),s=n(8173),c=n(2140),u=n(5112),l=r.TypeError,f=u("toPrimitive");e.exports=function(e,t){if(!o(e)||a(e))return e;var n,r=s(e,f);if(r){if(void 0===t&&(t="default"),n=i(r,e,t),!o(n)||a(n))return n;throw l("Can't convert object to primitive value")}return void 0===t&&(t="number"),c(e,t)}},4948:function(e,t,n){var r=n(7593),i=n(2190);e.exports=function(e){var t=r(e,"string");return i(t)?t:t+""}},1694:function(e,t,n){var r=n(5112),i=r("toStringTag"),o={};o[i]="z",e.exports="[object z]"===String(o)},6330:function(e,t,n){var r=n(7854),i=r.String;e.exports=function(e){try{return i(e)}catch(t){return"Object"}}},9711:function(e,t,n){var r=n(1702),i=0,o=Math.random(),a=r(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+a(++i+o,36)}},3307:function(e,t,n){var r=n(133);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},5112:function(e,t,n){var r=n(7854),i=n(2309),o=n(2597),a=n(9711),s=n(133),c=n(3307),u=i("wks"),l=r.Symbol,f=l&&l["for"],d=c?l:l&&l.withoutSetter||a;e.exports=function(e){if(!o(u,e)||!s&&"string"!=typeof u[e]){var t="Symbol."+e;s&&o(l,e)?u[e]=l[e]:u[e]=c&&f?f(t):d(t)}return u[e]}},6699:function(e,t,n){"use strict";var r=n(2109),i=n(1318).includes,o=n(1223);r({target:"Array",proto:!0},{includes:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),o("includes")},2087:function(e,t,n){var r=n(9781),i=n(3070),o=n(7066),a=n(7293),s=RegExp.prototype,c=r&&a((function(){return"sy"!==Object.getOwnPropertyDescriptor(s,"flags").get.call({dotAll:!0,sticky:!0})}));c&&i.f(s,"flags",{configurable:!0,get:o})},8675:function(e,t,n){"use strict";var r=n(260),i=n(6244),o=n(9303),a=r.aTypedArray,s=r.exportTypedArrayMethod;s("at",(function(e){var t=a(this),n=i(t),r=o(e),s=r>=0?r:n+r;return s<0||s>=n?void 0:t[s]}))},3462:function(e,t,n){"use strict";var r=n(7854),i=n(260),o=n(6244),a=n(4590),s=n(7908),c=n(7293),u=r.RangeError,l=i.aTypedArray,f=i.exportTypedArrayMethod,d=c((function(){new Int8Array(1).set({})}));f("set",(function(e){l(this);var t=a(arguments.length>1?arguments[1]:void 0,1),n=this.length,r=s(e),i=o(r),c=0;if(i+t>n)throw u("Wrong length");while(c<i)this[t+c]=r[c++]}),d)},1118:function(e,t,n){"use strict";var r=n(260),i=n(9671).findLastIndex,o=r.aTypedArray,a=r.exportTypedArrayMethod;a("findLastIndex",(function(e){return i(o(this),e,arguments.length>1?arguments[1]:void 0)}))},7380:function(e,t,n){"use strict";var r=n(260),i=n(9671).findLast,o=r.aTypedArray,a=r.exportTypedArrayMethod;a("findLast",(function(e){return i(o(this),e,arguments.length>1?arguments[1]:void 0)}))},3162:function(e,t,n){var r,i,o;(function(n,a){i=[],r=a,o="function"===typeof r?r.apply(t,i):r,void 0===o||(e.exports=o)})(0,(function(){"use strict";function t(e,t){return"undefined"==typeof t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function r(e,t,n){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="blob",r.onload=function(){c(r.response,t,n)},r.onerror=function(){console.error("could not download file")},r.send()}function i(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function o(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(r){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var a="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n.g&&n.g.global===n.g?n.g:void 0,s=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),c=a.saveAs||("object"!=typeof window||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(e,t,n){var s=a.URL||a.webkitURL,c=document.createElement("a");t=t||e.name||"download",c.download=t,c.rel="noopener","string"==typeof e?(c.href=e,c.origin===location.origin?o(c):i(c.href)?r(e,t,n):o(c,c.target="_blank")):(c.href=s.createObjectURL(e),setTimeout((function(){s.revokeObjectURL(c.href)}),4e4),setTimeout((function(){o(c)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,n,a){if(n=n||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(t(e,a),n);else if(i(e))r(e,n,a);else{var s=document.createElement("a");s.href=e,s.target="_blank",setTimeout((function(){o(s)}))}}:function(e,t,n,i){if(i=i||open("","_blank"),i&&(i.document.title=i.document.body.innerText="downloading..."),"string"==typeof e)return r(e,t,n);var o="application/octet-stream"===e.type,c=/constructor/i.test(a.HTMLElement)||a.safari,u=/CriOS\/[\d]+/.test(navigator.userAgent);if((u||o&&c||s)&&"undefined"!=typeof FileReader){var l=new FileReader;l.onloadend=function(){var e=l.result;e=u?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=e:location=e,i=null},l.readAsDataURL(e)}else{var f=a.URL||a.webkitURL,d=f.createObjectURL(e);i?i.location=d:location.href=d,i=null,setTimeout((function(){f.revokeObjectURL(d)}),4e4)}});a.saveAs=c.saveAs=c,e.exports=c}))},577:function(e){
/*!
* screenfull
* v5.2.0 - 2021-11-03
* (c) Sindre Sorhus; MIT License
*/
(function(){"use strict";var t="undefined"!==typeof window&&"undefined"!==typeof window.document?window.document:{},n=e.exports,r=function(){for(var e,n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],r=0,i=n.length,o={};r<i;r++)if(e=n[r],e&&e[1]in t){for(r=0;r<e.length;r++)o[n[0][r]]=e[r];return o}return!1}(),i={change:r.fullscreenchange,error:r.fullscreenerror},o={request:function(e,n){return new Promise(function(i,o){var a=function(){this.off("change",a),i()}.bind(this);this.on("change",a),e=e||t.documentElement;var s=e[r.requestFullscreen](n);s instanceof Promise&&s.then(a).catch(o)}.bind(this))},exit:function(){return new Promise(function(e,n){if(this.isFullscreen){var i=function(){this.off("change",i),e()}.bind(this);this.on("change",i);var o=t[r.exitFullscreen]();o instanceof Promise&&o.then(i).catch(n)}else e()}.bind(this))},toggle:function(e,t){return this.isFullscreen?this.exit():this.request(e,t)},onchange:function(e){this.on("change",e)},onerror:function(e){this.on("error",e)},on:function(e,n){var r=i[e];r&&t.addEventListener(r,n,!1)},off:function(e,n){var r=i[e];r&&t.removeEventListener(r,n,!1)},raw:r};r?(Object.defineProperties(o,{isFullscreen:{get:function(){return Boolean(t[r.fullscreenElement])}},element:{enumerable:!0,get:function(){return t[r.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return Boolean(t[r.fullscreenEnabled])}}}),n?e.exports=o:window.screenfull=o):n?e.exports={isEnabled:!1}:window.screenfull={isEnabled:!1}})()},3263:function(e,t,n){n(8675),n(3462),n(7380),n(1118),n(2087),n(6699),function(t){e.exports=t()}((function(){return function(){function e(t,n,r){function i(a,s){if(!n[a]){if(!t[a]){var c=void 0;if(!s&&c)return require(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[a]={exports:{}};t[a][0].call(l.exports,(function(e){var n=t[a][1][e];return i(n||e)}),l,l.exports,e,t,n,r)}return n[a].exports}for(var o=void 0,a=0;a<r.length;a++)i(r[a]);return i}return e}()({1:[function(e,t,n){"use strict";var r,i="object"===typeof Reflect?Reflect:null,o=i&&"function"===typeof i.apply?i.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};function a(e){console&&console.warn&&console.warn(e)}r=i&&"function"===typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var s=Number.isNaN||function(e){return e!==e};function c(){c.init.call(this)}t.exports=c,t.exports.once=w,c.EventEmitter=c,c.prototype._events=void 0,c.prototype._eventsCount=0,c.prototype._maxListeners=void 0;var u=10;function l(e){if("function"!==typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function f(e){return void 0===e._maxListeners?c.defaultMaxListeners:e._maxListeners}function d(e,t,n,r){var i,o,s;if(l(n),o=e._events,void 0===o?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),s=o[t]),void 0===s)s=o[t]=n,++e._eventsCount;else if("function"===typeof s?s=o[t]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),i=f(e),i>0&&s.length>i&&!s.warned){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=s.length,a(c)}return e}function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=h.bind(r);return i.listener=n,r.wrapFn=i,i}function m(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"===typeof i?n?[i.listener||i]:[i]:n?b(i):g(i,i.length)}function v(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"===typeof n)return 1;if(void 0!==n)return n.length}return 0}function g(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function y(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function b(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}function w(e,t){return new Promise((function(n,r){function i(n){e.removeListener(t,o),r(n)}function o(){"function"===typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}E(e,t,o,{once:!0}),"error"!==t&&_(e,i,{once:!0})}))}function _(e,t,n){"function"===typeof e.on&&E(e,"error",t,n)}function E(e,t,n,r){if("function"===typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!==typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){r.once&&e.removeEventListener(t,i),n(o)}))}}Object.defineProperty(c,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(e){if("number"!==typeof e||e<0||s(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");u=e}}),c.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},c.prototype.setMaxListeners=function(e){if("number"!==typeof e||e<0||s(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},c.prototype.getMaxListeners=function(){return f(this)},c.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var c=i[e];if(void 0===c)return!1;if("function"===typeof c)o(c,this,t);else{var u=c.length,l=g(c,u);for(n=0;n<u;++n)o(l[n],this,t)}return!0},c.prototype.addListener=function(e,t){return d(this,e,t,!1)},c.prototype.on=c.prototype.addListener,c.prototype.prependListener=function(e,t){return d(this,e,t,!0)},c.prototype.once=function(e,t){return l(t),this.on(e,p(this,e,t)),this},c.prototype.prependOnceListener=function(e,t){return l(t),this.prependListener(e,p(this,e,t)),this},c.prototype.removeListener=function(e,t){var n,r,i,o,a;if(l(t),r=this._events,void 0===r)return this;if(n=r[e],void 0===n)return this;if(n===t||n.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!==typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){a=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():y(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,a||t)}return this},c.prototype.off=c.prototype.removeListener,c.prototype.removeAllListeners=function(e){var t,n,r;if(n=this._events,void 0===n)return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)i=o[r],"removeListener"!==i&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],"function"===typeof t)this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},c.prototype.listeners=function(e){return m(this,e,!0)},c.prototype.rawListeners=function(e){return m(this,e,!1)},c.listenerCount=function(e,t){return"function"===typeof e.listenerCount?e.listenerCount(t):v.call(e,t)},c.prototype.listenerCount=v,c.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},{}],2:[function(e,t,n){var r,i,o=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function c(t){if(r===setTimeout)return setTimeout(t,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}function u(t){if(i===clearTimeout)return clearTimeout(t);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{return i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(function(){try{r="function"===typeof setTimeout?setTimeout:a}catch(e){r=a}try{i="function"===typeof clearTimeout?clearTimeout:s}catch(e){i=s}})();var l,f=[],d=!1,h=-1;function p(){d&&l&&(d=!1,l.length?f=l.concat(f):h=-1,f.length&&m())}function m(){if(!d){var e=c(p);d=!0;var t=f.length;while(t){l=f,f=[];while(++h<t)l&&l[h].run();h=-1,t=f.length}l=null,d=!1,u(e)}}function v(e,t){this.fun=e,this.array=t}function g(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];f.push(new v(e,t)),1!==f.length||d||c(m)},v.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=g,o.addListener=g,o.once=g,o.off=g,o.removeListener=g,o.removeAllListeners=g,o.emit=g,o.prependListener=g,o.prependOnceListener=g,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],3:[function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=e("../errors"),o=c(e("../events")),a=c(e("../event-handler")),s=c(e("../utils/mp4-encoder"));function c(e){return e&&e.__esModule?e:{default:e}}function u(){u=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(t){c=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var i=t&&t.prototype instanceof h?t:h,o=Object.create(i.prototype),a=new I(r||[]);return o._invoke=function(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return T()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===d)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=f(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===d)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}(e,n,a),o}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var d={};function h(){}function p(){}function m(){}var v={};c(v,o,(function(){return this}));var g=Object.getPrototypeOf,y=g&&g(g(S([])));y&&y!==t&&n.call(y,o)&&(v=y);var b=m.prototype=h.prototype=Object.create(v);function w(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function i(o,a,s,c){var u=f(e[o],e,a);if("throw"!==u.type){var l=u.arg,d=l.value;return d&&"object"==r(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){i("next",e,s,c)}),(function(e){i("throw",e,s,c)})):t.resolve(d).then((function(e){l.value=e,s(l)}),(function(e){return i("throw",e,s,c)}))}c(u.arg)}var o;this._invoke=function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}}function E(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method))return d;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var r=f(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,d;var i=r.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function S(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:T}}function T(){return{value:void 0,done:!0}}return p.prototype=m,c(b,"constructor",m),c(m,"constructor",p),p.displayName=c(m,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,c(e,s,"GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},w(_.prototype),c(_.prototype,a,(function(){return this})),e.AsyncIterator=_,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new _(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},w(b),c(b,s,"Generator"),c(b,o,(function(){return this})),c(b,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=S,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(A),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),A(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;A(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:S(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},e}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t,n){return t&&f(e.prototype,t),n&&f(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function h(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}function p(e,t){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},p(e,t)}function m(e){var t=y();return function(){var n,r=b(e);if(t){var i=b(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return v(this,n)}}function v(e,t){if(t&&("object"===r(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return g(e)}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function b(e){return b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},b(e)}function w(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function _(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){w(o,r,i,a,s,"next",e)}function s(e){w(o,r,i,a,s,"throw",e)}a(void 0)}))}}var E=null;function k(){return A.apply(this,arguments)}function A(){return A=_(u().mark((function e(){return u().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,s.default)().then((function(e){E=e}));case 2:case"end":return e.stop()}}),e)}))),A.apply(this,arguments)}var I=function(e){h(n,e);var t=m(n);function n(e){var r;return l(this,n),r=t.call(this,e,o.default.MEDIA_ATTACHING,o.default.BUFFER_APPENDING,o.default.BUFFER_RESET,o.default.RECORDING_START,o.default.RECORDING_STOP,o.default.H264_DATA_APPENDING,o.default.PLAYER_SEEK_NOW),r.rec_threshold_total=17179869184,r.rec_threshold_single=1073741824,r.rec_timer=void 0,r.rec_file="",r.rec_result_cb=void 0,r.rec_state_cb=void 0,r.mediaElement=null,r.mediaSource=null,r.mediaSize=0,r.sourceBuffers={},r.segments=[],r.h264Frames=[],r.appended=0,r.mediaErrorCount=0,r.count=0,r.recording=!1,r.onsbue=r.onSBUpdateEnd.bind(g(r)),r.browserType=0,-1!==navigator.userAgent.toLowerCase().indexOf("firefox")&&(r.browserType=1),r.mediaType="",r.websocketName=void 0,r.channelName=void 0,r._fs=null,r.track_info={width:0,height:0},k(),r.mp4BlobBuffer=[],r}return d(n,[{key:"destroy",value:function(){a.default.prototype.destroy.call(this)}},{key:"pad2",value:function(e){return e<10?"0"+e:e}},{key:"onRecordingProc",value:function(){var e=this;if(null==e._fs)return e.rec_result_cb&&e.rec_result_cb(!1),void console.log("fs is not authorized");e.rec_timer&&(clearInterval(e.rec_timer),e.rec_timer=void 0),e.count=0,e.rec_timer=setInterval((function(){if(""==e.mediaType||"H264Raw"==e.mediaType&&e.appended>10){clearInterval(e.rec_timer),e.rec_timer=void 0;var t=new Date,n=1900+t.getYear()+"-"+e.pad2(t.getMonth()+1)+"-"+e.pad2(t.getDate())+"_"+e.pad2(t.getHours())+"-"+e.pad2(t.getMinutes())+"-"+e.pad2(t.getSeconds());e.rec_file="ax_"+n+".mp4",console.log("MediaRecorder started: "+e.rec_file),e.mediaSize=0,e.recording=!0,e.rec_result_cb&&e.rec_result_cb(!0)}else e.count++;e.count>=10&&(clearInterval(e.rec_timer),e.rec_timer=void 0,e.rec_result_cb&&e.rec_result_cb(!1))}),1e3)}},{key:"onRecordingStart",value:function(e){if(this.recording)console.log("recording is in progress");else{void 0!=e&&(this.rec_threshold_single=e.rec_file_threshold,this.rec_result_cb=e.result_cb,this.rec_state_cb=e.state_cb);var t=this;navigator.webkitPersistentStorage.queryUsageAndQuota((function(e,n){""==n?t.requestFs():window.webkitRequestFileSystem(window.PERSISTENT,t.rec_threshold_total,(function(e){t._fs=e,e.root.getDirectory("ax_video",{create:!0},(function(e){console.log("Directory: "+e.name+" fs requested"),t.onRecordingProc()}),t.errorHandler)}))}),this.errorHandler)}}},{key:"onRecordingStop",value:function(){this.rec_timer&&(clearInterval(this.rec_timer),this.rec_timer=void 0,console.log("Media Recorder stopped2"));var e=this;e.recording=!1,e.saveToMP4Blob(e.h264Frames,this.track_info),e.h264Frames=[]}},{key:"errorHandler",value:function(e){var t="An error occured(errcd): ";console.log(t+e.code)}},{key:"requestFs",value:function(){var e=this;navigator.webkitPersistentStorage.requestQuota(this.rec_threshold_total,(function(t){console.log("grantedBytes: "+t),t>0?window.webkitRequestFileSystem(window.PERSISTENT,t,(function(t){e._fs=t,t.root.getDirectory("ax_video",{create:!0},(function(t){console.log("Directory: "+t.name+" exists or just created."),e.onRecordingProc()}),e.errorHandler)})):e.rec_result_cb&&e.rec_result_cb(!1)}))}},{key:"onMediaAttaching",value:function(e){var t=this.mediaElement=e.media;if(this.mediaType=e.mediaType,this.websocketName=e.websocketName,this.channelName=e.channelName,t){var n=this.mediaSource=new MediaSource;this.onmso=this.onMediaSourceOpen.bind(this),this.onmse=this.onMediaSourceEnded.bind(this),this.onmsc=this.onMediaSourceClose.bind(this),n.addEventListener("sourceopen",this.onmso),n.addEventListener("sourceended",this.onmse),n.addEventListener("sourceclose",this.onmsc),t.src=URL.createObjectURL(n)}}},{key:"onMediaDetaching",value:function(){}},{key:"onH264DataAppending",value:function(e){if(this.recording&&e.data){var t=this,n=e.data;t.h264Frames.push(e.data),t.mediaSize+=n.length,t.mediaSize>=t.rec_threshold_single&&(t.rec_state_cb&&t.rec_state_cb(!1),t.onRecordingStop(),t.onRecordingStart(),t.rec_state_cb&&t.rec_state_cb(!0))}}},{key:"saveToMP4Blob",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this,r=!1;if(e.length>0){var i=t.width,o=t.height,a=E.createEncoder({width:i,height:o,hevc:r});e.forEach((function(e){a.addNalu(e)}));var s=new Blob([a.end()]);n.writeMP4Data(s)}}},{key:"writeMP4Data",value:function(e){var t=this;t._fs.root.getFile("ax_video/"+t.rec_file,{create:!0},(function(n){n.createWriter((function(t){t.onwriteend=function(e){},t.onerror=function(e){console.log("Write rec data failed: "+e.toString())},t.seek(t.length),t.write(e)}),t.errorHandler)}),t.errorHandler)}},{key:"onBufferAppending",value:function(e){this.segments.push(e),this.doAppending()}},{key:"onMediaSourceClose",value:function(){console.log("media source closed")}},{key:"onMediaSourceEnded",value:function(){console.log("media source ended")}},{key:"onSBUpdateEnd",value:function(e){1===this.browserType&&(this.mediaSource.endOfStream(),this.media.play()),this.appending=!1,this.doAppending()}},{key:"onMediaSourceOpen",value:function(){console.log("media source open");var e=this.mediaSource;e&&e.removeEventListener("sourceopen",this.onmso),this.wfs.trigger(o.default.MEDIA_ATTACHED,{media:this.media,channelName:this.channelName,mediaType:this.mediaType,websocketName:this.websocketName})}},{key:"onBufferReset",value:function(e){"H264Raw"===this.mediaType&&this.createSourceBuffers({tracks:"video",mimeType:e.mimeType}),this.track_info.width=e.width,this.track_info.height=e.height}},{key:"createSourceBuffers",value:function(t){var n,r=this.sourceBuffers,i=this.mediaSource;n=""===t.mimeType?"video/mp4;codecs=avc1.420028":"video/mp4;codecs="+t.mimeType;try{var a=r["video"]=i.addSourceBuffer(n);a.addEventListener("updateend",this.onsbue)}catch(e){}this.wfs.trigger(o.default.BUFFER_CREATED,{tracks:t}),this.mediaElement.play()}},{key:"onPlayerSeekNow",value:function(){var e=this.mediaElement.buffered.end(0);this.mediaElement.currentTime=e}},{key:"doAppending",value:function e(){var t=this.wfs,n=this.sourceBuffers,r=this.segments;if(Object.keys(n).length){if(this.mediaElement.error){if(this.segments=[],this.mediaErrorCount++,this.mediaErrorCount<100)console.log("doAppending although a media error occured, error code:",this.media.error.code);else{var a={type:i.ErrorTypes.MEDIA_ERROR};a.details=i.ErrorDetails.BUFFER_APPEND_ERROR,a.frag=this.fragCurrent,a.fatal=!0,this.wfs.trigger(o.default.ERROR,a)}return}if(this.mediaErrorCount=0,this.appending)return;if(r&&r.length){var s=r.shift();try{n[s.type]&&(this.parent=s.parent,n[s.type].appendBuffer(s.data),this.appendError=0,this.appended++,this.appending=!0)}catch(e){r.unshift(s);var c={type:i.ErrorTypes.MEDIA_ERROR};22!==e.code?(this.appendError?this.appendError++:this.appendError=1,c.details=i.ErrorDetails.BUFFER_APPEND_ERROR,c.frag=this.fragCurrent,this.appendError>t.config.appendErrorMaxRetry?(r=[],c.fatal=!0):c.fatal=!1):(this.segments=[],c.details=i.ErrorDetails.BUFFER_FULL_ERROR,c.fatal=!0),this.wfs.trigger(o.default.ERROR,c)}}}}}]),n}(a.default),S=I;n.default=S},{"../errors":7,"../event-handler":8,"../events":9,"../utils/mp4-encoder":17}],4:[function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=a(e("../events")),o=a(e("../event-handler"));function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}function d(e){var t=m();return function(){var n,r=v(e);if(t){var i=v(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h(this,n)}}function h(e,t){if(t&&("object"===r(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return p(e)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}var g=function(e){l(n,e);var t=d(n);function n(e){var r;return s(this,n),r=t.call(this,e,i.default.MEDIA_ATTACHED,i.default.BUFFER_CREATED,i.default.FILE_PARSING_DATA,i.default.FILE_HEAD_LOADED,i.default.FILE_DATA_LOADED,i.default.WEBSOCKET_ATTACHED,i.default.FRAG_PARSING_DATA,i.default.FRAG_PARSING_INIT_SEGMENT),r.fileStart=0,r.fileEnd=0,r.pendingAppending=0,r.mediaType=void 0,r.channelName,r}return u(n,[{key:"destroy",value:function(){o.default.prototype.destroy.call(this)}},{key:"onMediaAttached",value:function(e){if(console.log("media attached"),void 0!=e.websocketName){var t="ws://"+window.location.host+"/"+e.websocketName,n="binary",r=new WebSocket(t,n);this.wfs.attachWebsocket(r,e.websocketName,e.channelName)}else console.log("websocketName ERROE!!!")}},{key:"onBufferCreated",value:function(e){this.mediaType=e.mediaType}},{key:"onFileHeadLoaded",value:function(e){}},{key:"onFileDataLoaded",value:function(e){}},{key:"onFileParsingData",value:function(e){}},{key:"onWebsocketAttached",value:function(e){this.wfs.trigger(i.default.BUFFER_APPENDING,{type:"video",data:e.payload,parent:"main"})}},{key:"onFragParsingInitSegment",value:function(e){var t,n=e.tracks,r=n.video;for(t in r&&(r.id=e.id),n){r=n[t];var o=r.initSegment;o&&(this.pendingAppending++,this.wfs.trigger(i.default.BUFFER_APPENDING,{type:t,data:o,parent:"main"}))}}},{key:"onFragParsingData",value:function(e){var t=this;[e.data1,e.data2].forEach((function(n){n&&(t.pendingAppending++,t.wfs.trigger(i.default.BUFFER_APPENDING,{type:e.type,data:n,parent:"main"}))}))}}]),n}(o.default),y=g;n.default=y},{"../event-handler":8,"../events":9}],5:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("../utils/logger");function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var s=function(){function e(t){i(this,e),this.data=t,this.bytesAvailable=this.data.byteLength,this.word=0,this.bitsAvailable=0}return a(e,[{key:"loadWord",value:function(){var e=this.data.byteLength-this.bytesAvailable,t=new Uint8Array(4),n=Math.min(4,this.bytesAvailable);if(0===n)throw new Error("no bytes available");t.set(this.data.subarray(e,e+n)),this.word=new DataView(t.buffer).getUint32(0),this.bitsAvailable=8*n,this.bytesAvailable-=n}},{key:"skipBits",value:function(e){var t;this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t>>3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}},{key:"readBits",value:function(e){var t=Math.min(this.bitsAvailable,e),n=this.word>>>32-t;return e>32&&r.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0?this.word<<=t:this.bytesAvailable>0&&this.loadWord(),t=e-t,t>0?n<<t|this.readBits(t):n}},{key:"skipLZ",value:function(){var e;for(e=0;e<this.bitsAvailable;++e)if(0!==(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}},{key:"skipUEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"skipEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"readUEG",value:function(){var e=this.skipLZ();return this.readBits(e+1)-1}},{key:"readEG",value:function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}},{key:"readBoolean",value:function(){return 1===this.readBits(1)}},{key:"readUByte",value:function(){return this.readBits(8)}},{key:"readUShort",value:function(){return this.readBits(16)}},{key:"readUInt",value:function(){return this.readBits(32)}},{key:"skipScalingList",value:function(e){var t,n,r=8,i=8;for(t=0;t<e;t++)0!==i&&(n=this.readEG(),i=(r+n+256)%256),r=0===i?r:i}},{key:"readSPS",value:function(){var e,t,n,r,i,o,a,s=0,c=0,u=0,l=0,f=1;if(this.readUByte(),e=this.readUByte(),this.readBits(5),this.skipBits(3),this.readUByte(),this.skipUEG(),100===e||110===e||122===e||244===e||44===e||83===e||86===e||118===e||128===e){var d=this.readUEG();if(3===d&&this.skipBits(1),this.skipUEG(),this.skipUEG(),this.skipBits(1),this.readBoolean())for(o=3!==d?8:12,a=0;a<o;a++)this.readBoolean()&&(a<6?this.skipScalingList(16):this.skipScalingList(64))}this.skipUEG();var h=this.readUEG();if(0===h)this.readUEG();else if(1===h)for(this.skipBits(1),this.skipEG(),this.skipEG(),t=this.readUEG(),a=0;a<t;a++)this.skipEG();if(this.skipUEG(),this.skipBits(1),n=this.readUEG(),r=this.readUEG(),i=this.readBits(1),0===i&&this.skipBits(1),this.skipBits(1),this.readBoolean()&&(s=this.readUEG(),c=this.readUEG(),u=this.readUEG(),l=this.readUEG()),this.readBoolean()&&this.readBoolean()){var p,m=this.readUByte();switch(m){case 1:p=[1,1];break;case 2:p=[12,11];break;case 3:p=[10,11];break;case 4:p=[16,11];break;case 5:p=[40,33];break;case 6:p=[24,11];break;case 7:p=[20,11];break;case 8:p=[32,11];break;case 9:p=[80,33];break;case 10:p=[18,11];break;case 11:p=[15,11];break;case 12:p=[64,33];break;case 13:p=[160,99];break;case 14:p=[4,3];break;case 15:p=[3,2];break;case 16:p=[2,1];break;case 255:p=[this.readUByte()<<8|this.readUByte(),this.readUByte()<<8|this.readUByte()];break}p&&(f=p[0]/p[1])}return{width:Math.ceil((16*(n+1)-2*s-2*c)*f),height:(2-i)*(r+1)*16-(i?2:4)*(u+l)}}},{key:"readSliceType",value:function(){return this.readUByte(),this.readUEG(),this.readUEG()}}]),e}(),c=s;n.default=c},{"../utils/logger":16}],6:[function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;e("../errors");var i=c(e("../events")),o=c(e("./exp-golomb")),a=c(e("../event-handler")),s=c(e("../remux/mp4-remuxer"));function c(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function d(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}function h(e,t){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},h(e,t)}function p(e){var t=g();return function(){var n,r=y(e);if(t){var i=y(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return m(this,n)}}function m(e,t){if(t&&("object"===r(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return v(e)}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},y(e)}var b=function(e){d(n,e);var t=p(n);function n(e){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;u(this,n),r=t.call(this,e,i.default.H264_DATA_PARSING),r.config=r.wfs.config||o,r.wfs=e,r.id="main";MediaSource.isTypeSupported("video/mp4");return r.remuxer=new s.default(r.wfs,r.id,r.config),r.contiguous=!0,r.timeOffset=1,r.sn=0,r.TIMESCALE=9e4,r.timestamp=0,r.scaleFactor=r.TIMESCALE/1e3,r.H264_TIMEBASE=r.config.mp4Duration,r._avcTrack={container:"video/mp4",type:"video",id:1,sequenceNumber:0,samples:[],len:0,nbNalu:0,dropped:0,count:0},r.browserType=0,-1!==navigator.userAgent.toLowerCase().indexOf("firefox")&&(r.browserType=1),r}return f(n,[{key:"destroy",value:function(){a.default.prototype.destroy.call(this)}},{key:"getTimestampM",value:function(){return this.timestamp+=this.H264_TIMEBASE,this.timestamp}},{key:"onH264DataParsing",value:function(e){this._parseAVCTrack(e.data),this.browserType,this.remuxer.pushVideo(0,this.sn,this._avcTrack,this.timeOffset,this.contiguous),this.sn+=1}},{key:"_parseAVCTrack",value:function(e){var t,n,r,a,s=this,c=this._avcTrack,u=c.samples,l=this._parseAVCNALu(e),f=[],d=!1,h=!1,p=0,m="",v=function(){if(f.length){if(!this.config.forceKeyFrameOnDiscontinuity||!0===h||c.sps&&(u.length||this.contiguous)){var e=this.getTimestampM();n={units:{units:f,length:p},pts:e,dts:e,key:h},u.push(n),c.len+=p,c.nbNalu+=f.length}else c.dropped++;f=[],p=0}}.bind(this);l.forEach((function(e){switch(e.type){case 1:r=!0,d&&(m+="NDR ");break;case 5:r=!0,d&&(m+="IDR "),h=!0;break;case 6:e.data=s.discardEPB(e.data),t=new o.default(e.data),t.readUByte();break;case 7:if(r=!1,d&&(m+="SPS "),!c.sps){t=new o.default(e.data);var n=t.readSPS();c.width=n.width,c.height=n.height,c.sps=[e.data],c.duration=0;var u=e.data.subarray(1,4),l="avc1.";for(a=0;a<3;a++){var g=u[a].toString(16);g.length<2&&(g="0"+g),l+=g}c.codec=l,s.wfs.trigger(i.default.BUFFER_RESET,{mimeType:c.codec,width:c.width,height:c.height}),r=!0}break;case 8:r=!1,d&&(m+="PPS "),c.pps||(c.pps=[e.data],r=!0);break;case 9:r=!1,d&&(m+="AUD "),v();break;default:r=!1,m+="unknown NAL "+e.type+" ";break}r&&(f.push(e),p+=e.data.byteLength)})),(d||m.length)&&logger.log(m),v()}},{key:"_parseAVCNALu",value:function(e){var t,n,r,i,o,a=0,s=e.byteLength,c=0,u=[];while(a<s)switch(t=e[a++],c){case 0:0===t&&(c=1);break;case 1:c=0===t?2:0;break;case 2:case 3:0===t?c=3:1===t&&a<s?(r=31&e[a],i&&(n={data:e.subarray(i,a-c-1),type:o},u.push(n)),i=a,o=r,c=0):c=0;break;default:break}return i&&(n={data:e.subarray(i,s),type:o,state:c},u.push(n)),u}},{key:"discardEPB",value:function(e){var t,n,r=e.byteLength,i=[],o=1;while(o<r-2)0===e[o]&&0===e[o+1]&&3===e[o+2]?(i.push(o+2),o+=2):o++;if(0===i.length)return e;t=r-i.length,n=new Uint8Array(t);var a=0;for(o=0;o<t;a++,o++)a===i[0]&&(a++,i.shift()),n[o]=e[a];return n}}]),n}(a.default),w=b;n.default=w},{"../errors":7,"../event-handler":8,"../events":9,"../remux/mp4-remuxer":15,"./exp-golomb":5}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ErrorTypes=n.ErrorDetails=void 0;var r={NETWORK_ERROR:"networkError",MEDIA_ERROR:"mediaError",OTHER_ERROR:"otherError"};n.ErrorTypes=r;var i={MANIFEST_LOAD_ERROR:"manifestLoadError",MANIFEST_LOAD_TIMEOUT:"manifestLoadTimeOut",MANIFEST_PARSING_ERROR:"manifestParsingError",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"manifestIncompatibleCodecsError",LEVEL_LOAD_ERROR:"levelLoadError",LEVEL_LOAD_TIMEOUT:"levelLoadTimeOut",LEVEL_SWITCH_ERROR:"levelSwitchError",AUDIO_TRACK_LOAD_ERROR:"audioTrackLoadError",AUDIO_TRACK_LOAD_TIMEOUT:"audioTrackLoadTimeOut",FRAG_LOAD_ERROR:"fragLoadError",FRAG_LOOP_LOADING_ERROR:"fragLoopLoadingError",FRAG_LOAD_TIMEOUT:"fragLoadTimeOut",FRAG_DECRYPT_ERROR:"fragDecryptError",FRAG_PARSING_ERROR:"fragParsingError",KEY_LOAD_ERROR:"keyLoadError",KEY_LOAD_TIMEOUT:"keyLoadTimeOut",BUFFER_ADD_CODEC_ERROR:"bufferAddCodecError",BUFFER_APPEND_ERROR:"bufferAppendError",BUFFER_APPENDING_ERROR:"bufferAppendingError",BUFFER_STALLED_ERROR:"bufferStalledError",BUFFER_FULL_ERROR:"bufferFullError",BUFFER_SEEK_OVER_HOLE:"bufferSeekOverHole",INTERNAL_EXCEPTION:"internalException",NETWORK_RECV_DATA_TIMEOUT:"networkRecvDataTimeout"};n.ErrorDetails=i},{}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;r(e("./events"));function r(e){return e&&e.__esModule?e:{default:e}}function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var c=function(){function e(t){o(this,e),this.wfs=t,this.onEvent=this.onEvent.bind(this);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.handledEvents=r,this.useGenericHandler=!0,this.registerListeners()}return s(e,[{key:"destroy",value:function(){this.unregisterListeners()}},{key:"isEventHandler",value:function(){return"object"===i(this.handledEvents)&&this.handledEvents.length&&"function"===typeof this.onEvent}},{key:"registerListeners",value:function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){this.wfs.on(e,this.onEvent)}.bind(this))}},{key:"unregisterListeners",value:function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){this.wfs.off(e,this.onEvent)}.bind(this))}},{key:"onEvent",value:function(e,t){this.onEventGeneric(e,t)}},{key:"onEventGeneric",value:function e(t,n){var r=function(e,t){var n="on"+e.replace("wfs","");return this[n],this[n].bind(this,t)};try{r.call(this,t,n).call()}catch(e){console.log("internal error happened while processing ".concat(t,":").concat(e.message))}}}]),e}(),u=c;n.default=u},{"./events":9}],9:[function(e,t,n){"use strict";t.exports={MEDIA_ATTACHING:"wfsMediaAttaching",MEDIA_ATTACHED:"wfsMediaAttached",FRAG_LOADING:"wfsFragLoading",BUFFER_CREATED:"wfsBufferCreated",BUFFER_APPENDING:"wfsBufferAppending",BUFFER_RESET:"wfsBufferReset",BUFFER_CLEAR:"wfsBufferClear",FRAG_PARSING_DATA:"wfsFragParsingData",FRAG_PARSING_INIT_SEGMENT:"wfsFragParsingInitSegment",H264_DATA_APPENDING:"wfsH264DataAppending",H264_DATA_PARSING:"wfsH264DataParsing",WEBSOCKET_ATTACHED:"wfsWebsocketAttached",WEBSOCKET_ATTACHING:"wfsWebsocketAttaching",WEBSOCKET_DATA_UPLOADING:"wfsWebsocketDataUploading",WEBSOCKET_MESSAGE_SENDING:"wfsWebsocketMessageSending",FILE_HEAD_LOADING:"wfsFileHeadLoading",FILE_HEAD_LOADED:"wfsFileHeadLoaded",FILE_DATA_LOADING:"wfsFileDataLoading",FILE_DATA_LOADED:"wfsFileDataLoaded",FILE_PARSING_DATA:"wfsFileParsingData",RECORDING_START:"wfsRecordingStart",PLAYER_SEEK_NOW:"wfsPlayerSeekNow",RECORDING_STOP:"wfsRecordingStop",ERROR:"wfsError"}},{}],10:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=function(){function e(){r(this,e)}return o(e,null,[{key:"getSilentFrame",value:function(e){return 1===e?new Uint8Array([0,200,0,128,35,128]):2===e?new Uint8Array([33,0,73,144,2,25,0,35,128]):3===e?new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]):4===e?new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]):5===e?new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]):6===e?new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]):null}}]),e}(),s=a;n.default=s},{}],11:[function(e,t,n){"use strict";t.exports=e("./wfs.js").default},{"./wfs.js":20}],12:[function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=a(e("../events")),o=a(e("../event-handler"));function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}function d(e){var t=m();return function(){var n,r=v(e);if(t){var i=v(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h(this,n)}}function h(e,t){if(t&&("object"===r(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return p(e)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}var g=function(e){l(n,e);var t=d(n);function n(e){var r;return s(this,n),r=t.call(this,e,i.default.FRAG_LOADING,i.default.FILE_HEAD_LOADING,i.default.FILE_DATA_LOADING),r.loaders={},r}return u(n,[{key:"destroy",value:function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy()}this.loaders={},o.default.prototype.destroy.call(this)}},{key:"onFileHeadLoading",value:function(e){var t,n,r,i=this.wfs.config,o=new i.loader(i);t={url:i.fmp4FileUrl},n={maxRetry:0,retryDelay:0},r={onSuccess:this.fileloadheadsuccess.bind(this)},o.loadHead(t,n,r)}},{key:"fileloadheadsuccess",value:function(e){this.wfs.trigger(i.default.FILE_HEAD_LOADED,{size:e})}},{key:"onFileDataLoading",value:function(e){var t,n,r,i=this.wfs.config,o=new i.loader(i);t={url:i.fmp4FileUrl,responseType:"arraybuffer",progressData:!1};var a=e.fileStart,s=e.fileEnd;isNaN(a)||isNaN(s)||(t.rangeStart=a,t.rangeEnd=s),n={timeout:i.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:i.fragLoadingMaxRetryTimeout},r={onSuccess:this.fileloaddatasuccess.bind(this)},o.load(t,n,r)}},{key:"fileloaddatasuccess",value:function(e,t,n){this.wfs.trigger(i.default.FILE_DATA_LOADED,{payload:e.data,stats:t})}},{key:"loaderror",value:function(e,t){var n=t.loader;n&&n.abort(),this.loaders[t.type]=void 0}},{key:"loadtimeout",value:function(e,t){var n=t.loader;n&&n.abort(),this.loaders[t.type]=void 0}},{key:"loadprogress",value:function(e,t,n){var r=t.frag;r.loaded=e.loaded}}]),n}(o.default),y=g;n.default=y},{"../event-handler":8,"../events":9}],13:[function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=e("../errors"),o=c(e("../events")),a=c(e("../event-handler")),s=c(e("../demux/h264-demuxer"));function c(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function d(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}function h(e,t){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},h(e,t)}function p(e){var t=g();return function(){var n,r=y(e);if(t){var i=y(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return m(this,n)}}function m(e,t){if(t&&("object"===r(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return v(e)}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},y(e)}var b=function(e){d(n,e);var t=p(n);function n(e){var r;return u(this,n),r=t.call(this,e,o.default.WEBSOCKET_ATTACHING,o.default.WEBSOCKET_DATA_UPLOADING,o.default.WEBSOCKET_MESSAGE_SENDING),r.buf=null,r.ctx=null,r.h264Demuxer=new s.default(e),r.websocketName=void 0,r.media=void 0,r.mediaType=void 0,r.mediaCode=0,r.channelName=void 0,r.isForceClosed=!1,r.timer=void 0,r.lastRecvDataTime=0,r.extraData=void 0,r.isLoaded=!1,r}return f(n,[{key:"create_timer",value:function(){var e=this;this.lastRecvDataTime=performance.now(),console.log("Websocket: create_timer"),this.timer=setInterval((function(){if(e.lastRecvDataTime>0){var t=performance.now(),n=t-e.lastRecvDataTime;if(n>e.wfs.config.wsMinPacketInterval&&console.log("Websocket: did not recv data over "+n+" ms"),n>e.wfs.config.wsMaxPacketInterval&&!e.isForceClosed){e.unload(),console.log("Websocket data not received in "+e.wfs.config.wsMaxPacketInterval/1e3+"s, open again...");var r={type:i.ErrorTypes.NETWORK_ERROR};r.details=i.ErrorDetails.NETWORK_RECV_DATA_TIMEOUT,r.fatal=!0,e.wfs.trigger(o.default.ERROR,r)}}else e.lastRecvDataTime=performance.now()}),this.wfs.config.wsMinPacketInterval)}},{key:"kill_timer",value:function(){this.timer&&(console.log("Websocket close: clear timer"),clearInterval(this.timer),this.timer=void 0)}},{key:"destroy",value:function(){this.kill_timer(),this.isForceClosed=!0,this.client&&this.client.close(),a.default.prototype.destroy.call(this)}},{key:"onWebsocketAttaching",value:function(e){switch(this.kill_timer(),this.create_timer(),e.mediaType){case"MJPEG":this.mediaCode=1,this.ctx=e.media.getContext("2d");break;case"H264Raw":default:this.mediaCode=0;break}this.websocketName=e.websocketName,this.media=e.media,this.mediaType=e.mediaType,this.channelName=e.channelName,this.extraData=e.extraData,e.websocket instanceof WebSocket&&(this.client=e.websocket,this.client.onopen=this.initSocketClient.bind(this),this.client.onclose=this.closeSocketClient.bind(this),this.client.onerror=this.errorSocketClient.bind(this))}},{key:"errorSocketClient",value:function(e){this.unload(),console.log("WebSocket error: ",e)}},{key:"closeSocketClient",value:function(e){this.unload(),console.log("Websocket closed: ",e)}},{key:"initSocketClient",value:function(e){this.load(),console.log("Websocket Open!")}},{key:"receiveSocketMessage",value:function(e){var t=this;if(this.isLoaded)if(this.lastRecvDataTime=performance.now(),0===this.mediaCode){this.buf=new Uint8Array(e.data);var n=new Uint8Array(this.buf),r=new Uint8Array(this.buf);this.wfs.trigger(o.default.H264_DATA_PARSING,{data:n}),this.wfs.trigger(o.default.H264_DATA_APPENDING,{data:r})}else if(1===this.mediaCode)if(this.extraData){if(!this.extraData.isDrawImg)return;if(void 0==this.media||!this.media)return;var i=new FileReader;i.onload=function(e){if(e.target.readyState===FileReader.DONE){var n=t.ctx,r=new Image,i=t.extraData.mjpeg_w,o=t.extraData.mjpeg_h,a=t.extraData.sizeOptionInd,s=t.extraData.getObjectFitSize;r.onload=function(){if(n.clearRect(0,0,i,o),1===a){var e=s(a,i,o,this.width,this.height),t=e.sx,c=e.sy,u=e.swidth,l=e.sheight,f=e.x,d=e.y,h=e.width,p=e.height;n.drawImage(r,t,c,u,l,f,d,h,p)}else n.drawImage(r,0,0,i,o)},r.src=e.target.result}},i.readAsDataURL(e.data)}else console.log("extraData is undefined"),this.extraData=this.wfs.extraData}},{key:"onWebsocketDataUploading",value:function(e){this.client.send(e.data)}},{key:"onWebsocketMessageSending",value:function(e){this.client.send(JSON.stringify({t:e.commandType,c:e.channelName,v:e.commandValue}))}},{key:"load",value:function(){0===this.mediaCode&&(this.client.binaryType="arraybuffer"),this.client.onmessage=this.receiveSocketMessage.bind(this),this.wfs.trigger(o.default.WEBSOCKET_MESSAGE_SENDING,{commandType:"open",channelName:this.channelName,commandValue:"NA"}),this.isLoaded=!0}},{key:"unload",value:function(){this.isLoaded=!1,1===this.mediaCode&&this.ctx.clearRect(0,0,this.extraData.mjpeg_w,this.extraData.mjpeg_h)}}]),n}(a.default),w=b;n.default=w},{"../demux/h264-demuxer":6,"../errors":7,"../event-handler":8,"../events":9}],14:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=function(){function e(){r(this,e)}return o(e,null,[{key:"init",value:function(){var t;for(t in e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var n=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:n,audio:r};var i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),o=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=o,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var a=new Uint8Array([105,115,111,109]),s=new Uint8Array([97,118,99,49]),c=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,a,c,a,s),e.DINF=e.box(e.types.dinf,e.box(e.types.dref,i))}},{key:"box",value:function(e){var t,n=Array.prototype.slice.call(arguments,1),r=8,i=n.length,o=i;while(i--)r+=n[i].byteLength;for(t=new Uint8Array(r),t[0]=r>>24&255,t[1]=r>>16&255,t[2]=r>>8&255,t[3]=255&r,t.set(e,4),i=0,r=8;i<o;i++)t.set(n[i],r),r+=n[i].byteLength;return t}},{key:"hdlr",value:function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])}},{key:"mdat",value:function(t){return e.box(e.types.mdat,t)}},{key:"mdhd",value:function(t,n){return n*=t,e.box(e.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24,n>>16&255,n>>8&255,255&n,85,196,0,0]))}},{key:"mdia",value:function(t){return e.box(e.types.mdia,e.mdhd(t.timescale,t.duration),e.hdlr(t.type),e.minf(t))}},{key:"mfhd",value:function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))}},{key:"minf",value:function(t){return"audio"===t.type?e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(t)):e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(t))}},{key:"moof",value:function(t,n,r){return e.box(e.types.moof,e.mfhd(t),e.traf(r,n))}},{key:"moov",value:function(t){var n=t.length,r=[];while(n--)r[n]=e.trak(t[n]);return e.box.apply(null,[e.types.moov,e.mvhd(t[0].timescale,t[0].duration)].concat(r).concat(e.mvex(t)))}},{key:"mvex",value:function(t){var n=t.length,r=[];while(n--)r[n]=e.trex(t[n]);return e.box.apply(null,[e.types.mvex].concat(r))}},{key:"mvhd",value:function(t,n){n=0;var r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24&255,n>>16&255,n>>8&255,255&n,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,r)}},{key:"sdtp",value:function(t){var n,r,i=t.samples||[],o=new Uint8Array(4+i.length);for(r=0;r<i.length;r++)n=i[r].flags,o[r+4]=n.dependsOn<<4|n.isDependedOn<<2|n.hasRedundancy;return e.box(e.types.sdtp,o)}},{key:"stbl",value:function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))}},{key:"avc1",value:function(t){var n,r,i,o=[],a=[];for(n=0;n<t.sps.length;n++)r=t.sps[n],i=r.byteLength,o.push(i>>>8&255),o.push(255&i),o=o.concat(Array.prototype.slice.call(r));for(n=0;n<t.pps.length;n++)r=t.pps[n],i=r.byteLength,a.push(i>>>8&255),a.push(255&i),a=a.concat(Array.prototype.slice.call(r));var s=e.box(e.types.avcC,new Uint8Array([1,o[3],o[4],o[5],255,224|t.sps.length].concat(o).concat([t.pps.length]).concat(a))),c=t.width,u=t.height;return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,c>>8&255,255&c,u>>8&255,255&u,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,106,101,102,102,45,121,97,110,47,47,47,103,119,102,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))}},{key:"esds",value:function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}},{key:"mp4a",value:function(t){var n=t.audiosamplerate;return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,n>>8&255,255&n,0,0]),e.box(e.types.esds,e.esds(t)))}},{key:"stsd",value:function(t){return"audio"===t.type?e.box(e.types.stsd,e.STSD,e.mp4a(t)):e.box(e.types.stsd,e.STSD,e.avc1(t))}},{key:"tkhd",value:function(t){var n=t.id,r=t.duration*t.timescale,i=t.width,o=t.height;return e.box(e.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,n>>24&255,n>>16&255,n>>8&255,255&n,0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,255&i,0,0,o>>8&255,255&o,0,0]))}},{key:"traf",value:function(t,n){var r=e.sdtp(t),i=t.id;return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i])),e.box(e.types.tfdt,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n])),e.trun(t,r.length+16+16+8+16+8+8),r)}},{key:"trak",value:function(t){return t.duration=t.duration||4294967295,e.box(e.types.trak,e.tkhd(t),e.mdia(t))}},{key:"trex",value:function(t){var n=t.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}},{key:"trun",value:function(t,n){var r,i,o,a,s,c,u=t.samples||[],l=u.length,f=12+16*l,d=new Uint8Array(f);for(n+=8+f,d.set([0,0,15,1,l>>>24&255,l>>>16&255,l>>>8&255,255&l,n>>>24&255,n>>>16&255,n>>>8&255,255&n],0),r=0;r<l;r++)i=u[r],o=i.duration,a=i.size,s=i.flags,c=i.cts,d.set([o>>>24&255,o>>>16&255,o>>>8&255,255&o,a>>>24&255,a>>>16&255,a>>>8&255,255&a,s.isLeading<<2|s.dependsOn,s.isDependedOn<<6|s.hasRedundancy<<4|s.paddingValue<<1|s.isNonSync,61440&s.degradPrio,15&s.degradPrio,c>>>24&255,c>>>16&255,c>>>8&255,255&c],12+16*r);return e.box(e.types.trun,d)}},{key:"initSegment",value:function(t){e.types||e.init();var n,r=e.moov(t);return n=new Uint8Array(e.FTYP.byteLength+r.byteLength),n.set(e.FTYP),n.set(r,e.FTYP.byteLength),n}}]),e}(),s=a;n.default=s},{}],15:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=c(e("../helper/aac")),i=c(e("../events")),o=e("../utils/logger"),a=c(e("../remux/mp4-generator")),s=e("../errors");function c(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}e("../utils/polyfill");var d=function(){function e(t,n,r){u(this,e),this.observer=t,this.id=n,this.config=r,this.ISGenerated=!1,this.PES2MP4SCALEFACTOR=4,this.PES_TIMESCALE=9e4,this.MP4_TIMESCALE=this.PES_TIMESCALE/this.PES2MP4SCALEFACTOR,this.nextAvcDts=90300,this.H264_TIMEBASE=this.config.mp4Duration,this.genISFailCount=0}return f(e,[{key:"passthrough",get:function(){return!1}},{key:"destroy",value:function(){}},{key:"insertDiscontinuity",value:function(){this._initPTS=this._initDTS=void 0}},{key:"switchLevel",value:function(){this.ISGenerated=!1,this.genISFailCount=0}},{key:"pushVideo",value:function(e,t,n,r,i){this.level=e,this.sn=t,this.ISGenerated||this.generateVideoIS(n,r),this.ISGenerated&&this.remuxVideo_2(n,r,i)}},{key:"remuxVideo_2",value:function(e,t,n,r){var s,c,u=8,l=e.samples,f=[];s=new Uint8Array(e.len+4*e.nbNalu+8);var d=new DataView(s.buffer);d.setUint32(0,s.byteLength),s.set(a.default.types.mdat,4);for(var h,p,m,v=0,g=0;g<l.length;g++){var y=l[g],b=0;while(y.units.units.length){var w=y.units.units.shift();d.setUint32(u,w.data.byteLength),u+=4,s.set(w.data,u),u+=w.data.byteLength,b+=4+w.data.byteLength}var _=y.pts-this._initPTS,E=y.dts-this._initDTS;if(E=Math.min(_,E),void 0!==m)h=this._PTSNormalize(_,m),p=this._PTSNormalize(E,m),v=p-m,v<=0&&(o.logger.log("invalid sample duration at PTS/DTS: ".concat(y.pts,"/").concat(y.dts,"|dts norm: ").concat(p,"|lastDTS: ").concat(m,":").concat(v)),v=1);else{var k,A=this.nextAvcDts;h=this._PTSNormalize(_,A),p=this._PTSNormalize(E,A),A&&(k=Math.round(p-A),Math.abs(k)<600&&k&&(k>1?o.logger.log("AVC:".concat(k," ms hole between fragments detected,filling it")):k<-1&&o.logger.log("AVC:".concat(-k," ms overlapping between fragments detected")),p=A,h=Math.max(h-k,p),o.logger.log("Video/PTS/DTS adjusted: ".concat(h,"/").concat(p,",delta:").concat(k)))),this.firstPTS=Math.max(0,h),this.firstDTS=Math.max(0,p),v=.03}f.push({size:b,duration:this.H264_TIMEBASE,cts:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:y.key?2:1,isNonSync:y.key?0:1}}),m=p}var I=0;if(f.length>=2&&(I=f[f.length-2].duration,f[0].duration=I),this.nextAvcDts=p+I,e.len=0,e.nbNalu=0,e.dropped=0,f.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var S=f[0].flags;S.dependsOn=2,S.isNonSync=0}e.samples=f,c=a.default.moof(e.sequenceNumber++,p,e),e.samples=[];var T={data1:c,data2:s,type:"video"};return this.observer.trigger(i.default.FRAG_PARSING_DATA,T),T}},{key:"generateVideoIS",value:function(e,t){var n,r,o=this.observer,c=e.samples,u=(this.PES_TIMESCALE,{}),l={id:this.id,level:this.level,sn:this.sn,tracks:u,unique:!1},f=void 0===this._initPTS;f&&(n=r=1/0),e.sps&&e.pps&&c.length&&(e.timescale=9e4,u.video={container:"video/mp4",codec:e.codec,initSegment:a.default.initSegment([e]),metadata:{width:e.width,height:e.height}},f&&(n=Math.min(n,c[0].pts-this.H264_TIMEBASE),r=Math.min(r,c[0].dts-this.H264_TIMEBASE))),Object.keys(u).length?(o.trigger(i.default.FRAG_PARSING_INIT_SEGMENT,l),this.ISGenerated=!0,this.genISFailCount=0,f&&(this._initPTS=n,this._initDTS=r)):(this.genISFailCount++,this.genISFailCount>60&&console.log("generateVideoIS ERROR: ",s.ErrorTypes.MEDIA_ERROR))}},{key:"remux",value:function(e,t,n,r,o,a,s,c){if(this.level=e,this.sn=t,this.ISGenerated||this.generateIS(n,r,s),this.ISGenerated)if(n.samples.length){var u,l=this.remuxAudio(n,s,c);if(r.samples.length)l&&(u=l.endPTS-l.startPTS),this.remuxVideo(r,s,c,u)}else{var f;r.samples.length&&(f=this.remuxVideo(r,s,c)),f&&n.codec&&this.remuxEmptyAudio(n,s,c,f)}o.samples.length&&this.remuxID3(o,s),a.samples.length&&this.remuxText(a,s),this.observer.trigger(i.default.FRAG_PARSED,{id:this.id,level:this.level,sn:this.sn})}},{key:"generateIS",value:function(e,t,n){var r,c,u=this.observer,l=e.samples,f=t.samples,d=this.PES_TIMESCALE,h={},p={id:this.id,level:this.level,sn:this.sn,tracks:h,unique:!1},m=void 0===this._initPTS;if(m&&(r=c=1/0),e.config&&l.length){if(e.timescale=e.audiosamplerate,e.timescale*e.duration>Math.pow(2,32)){var v=function e(t,n){return n?e(n,t%n):t};e.timescale=e.audiosamplerate/v(e.audiosamplerate,1024)}o.logger.log("audio mp4 timescale :"+e.timescale),h.audio={container:"audio/mp4",codec:e.codec,initSegment:a.default.initSegment([e]),metadata:{channelCount:e.channelCount}},m&&(r=c=l[0].pts-d*n)}t.sps&&t.pps&&f.length&&(t.timescale=this.MP4_TIMESCALE,h.video={container:"video/mp4",codec:t.codec,initSegment:a.default.initSegment([t]),metadata:{width:t.width,height:t.height}},m&&(r=Math.min(r,f[0].pts-d*n),c=Math.min(c,f[0].dts-d*n))),Object.keys(h).length?(u.trigger(i.default.FRAG_PARSING_INIT_SEGMENT,p),this.ISGenerated=!0,m&&(this._initPTS=r,this._initDTS=c)):u.trigger(i.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,id:this.id,details:s.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})}},{key:"remuxAudio",value:function(e,t,n){var s,c,u,l,f,d,h,p,m,v,g,y,b,w=this.PES_TIMESCALE,_=e.timescale,E=w/_,k=1024*e.timescale/e.audiosamplerate,A=8,I=[],S=[];e.samples.sort((function(e,t){return e.pts-t.pts})),S=e.samples;for(var T=n?this.nextAacPts:t*w,C=this._PTSNormalize(S[0].pts-this._initPTS,T),O=k*E,R=C+O,x=1;x<S.length;){var P=S[x],F=this._PTSNormalize(P.pts-this._initPTS,T),L=F-R;if(L<-.5*O)o.logger.log("Dropping frame due to ".concat(Math.abs(L/90)," ms overlap.")),S.splice(x,1),e.len-=P.unit.length;else if(L>.5*O){var D=Math.round(L/O);o.logger.log("Injecting ".concat(D," frame").concat(D>1?"s":""," of missing audio due to ").concat(Math.round(L/90)," ms gap."));for(var j=0;j<D;j++){var H=S[x-1].pts+O,M=r.default.getSilentFrame(e.channelCount);M||(o.logger.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),M=P.unit.slice(0)),S.splice(x,0,{unit:M,pts:H,dts:H}),e.len+=M.length,x+=1}R+=(D+1)*O,P.pts=S[x-1].pts+O,x+=1}else Math.abs(L)>.1*O&&o.logger.log("Invalid frame delta ".concat(F-R+O," at PTS ").concat(Math.round(F/90)," (should be ").concat(O,").")),R+=O,P.pts=S[x-1].pts+O,x+=1}while(S.length){if(c=S.shift(),l=c.unit,v=c.pts-this._initDTS,g=c.dts-this._initDTS,void 0!==m)y=this._PTSNormalize(v,m),b=this._PTSNormalize(g,m),u.duration=(b-m)/E;else{y=this._PTSNormalize(v,T),b=this._PTSNormalize(g,T);var N=Math.round(1e3*(y-T)/w);if(n&&N){if(N>0)o.logger.log("".concat(N," ms hole between AAC samples detected,filling it"));else if(N<-12){o.logger.log("".concat(-N," ms overlapping between AAC samples detected, drop frame")),e.len-=l.byteLength;continue}y=b=T}if(h=Math.max(0,y),p=Math.max(0,b),!(e.len>0))return;f=new Uint8Array(e.len+8),s=new DataView(f.buffer),s.setUint32(0,f.byteLength),f.set(a.default.types.mdat,4)}f.set(l,A),A+=l.byteLength,u={size:l.byteLength,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},I.push(u),m=b}var U=0,B=I.length;if(B>=2&&(U=I[B-2].duration,u.duration=U),B){this.nextAacPts=y+E*U,e.len=0,e.samples=I,d=a.default.moof(e.sequenceNumber++,p/E,e),e.samples=[];var V={id:this.id,level:this.level,sn:this.sn,data1:d,data2:f,startPTS:h/w,endPTS:this.nextAacPts/w,startDTS:p/w,endDTS:(b+E*U)/w,type:"audio",nb:B};return this.observer.trigger(i.default.FRAG_PARSING_DATA,V),V}return null}},{key:"remuxEmptyAudio",value:function(e,t,n,i){var a=this.PES_TIMESCALE,s=e.timescale?e.timescale:e.audiosamplerate,c=a/s,u=i.startDTS*a+this._initDTS,l=i.endDTS*a+this._initDTS,f=1024,d=c*f,h=Math.ceil((l-u)/d),p=r.default.getSilentFrame(e.channelCount);if(p){for(var m=[],v=0;v<h;v++){var g=u+v*d;m.push({unit:p.slice(0),pts:g,dts:g}),e.len+=p.length}e.samples=m,this.remuxAudio(e,t,n)}else o.logger.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!")}},{key:"remuxID3",value:function(e,t){var n,r=e.samples.length;if(r){for(var o=0;o<r;o++)n=e.samples[o],n.pts=(n.pts-this._initPTS)/this.PES_TIMESCALE,n.dts=(n.dts-this._initDTS)/this.PES_TIMESCALE;this.observer.trigger(i.default.FRAG_PARSING_METADATA,{id:this.id,level:this.level,sn:this.sn,samples:e.samples})}e.samples=[]}},{key:"remuxText",value:function(e,t){e.samples.sort((function(e,t){return e.pts-t.pts}));var n,r=e.samples.length;if(r){for(var o=0;o<r;o++)n=e.samples[o],n.pts=(n.pts-this._initPTS)/this.PES_TIMESCALE;this.observer.trigger(i.default.FRAG_PARSING_USERDATA,{id:this.id,level:this.level,sn:this.sn,samples:e.samples})}e.samples=[]}},{key:"_PTSNormalize",value:function(e,t){var n;if(void 0===t)return e;n=t<e?-8589934592:8589934592;while(Math.abs(e-t)>4294967296)e+=n;return e}}]),e}(),h=d;n.default=h},{"../errors":7,"../events":9,"../helper/aac":10,"../remux/mp4-generator":14,"../utils/logger":16,"../utils/polyfill":18}],16:[function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(){}Object.defineProperty(n,"__esModule",{value:!0}),n.logger=n.enableLogs=void 0;var o={trace:i,debug:i,log:i,warn:i,info:i,error:i},a=o;function s(e,t){return t="["+e+"] > "+t,t}function c(e){var t=window.console[e];return t?function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];r[0]&&(r[0]=s(e,r[0])),t.apply(window.console,r)}:i}function u(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];n.forEach((function(t){a[t]=e[t]?e[t].bind(e):c(t)}))}var l=function(t){if(!0===t||"object"===r(t)){u(t,"debug","log","info","warn","error");try{a.log()}catch(e){a=o}}else a=o};n.enableLogs=l;var f=a;n.logger=f},{}],17:[function(e,t,n){(function(e){(function(){"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.createEncoderWithModule=a,n.createFile=o,n.default=void 0;var r=function(){var n="undefined"!==typeof document&&document.currentScript?document.currentScript.src:void 0;return function(r){r=r||{};var i,o;r="undefined"!=typeof r?r:{};r["ready"]=new Promise((function(e,t){i=e,o=t})),r["createEncoder"]=function(e){return a(r,e)};var s,c=Object.assign({},r),u=[],l="object"==("undefined"===typeof window?"undefined":t(window)),f="function"==typeof importScripts,d=("object"==("undefined"===typeof e?"undefined":t(e))&&"object"==t(e.versions)&&e.versions.node,"");function h(e){return r["locateFile"]?r["locateFile"](e,d):d+e}(l||f)&&(f?d=self.location.href:"undefined"!=typeof document&&document.currentScript&&(d=document.currentScript.src),n&&(d=n),d=0!==d.indexOf("blob:")?d.substr(0,d.replace(/[?#].*/,"").lastIndexOf("/")+1):"",function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},f&&(s=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),function(e,t,n){var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.onload=function(){200==r.status||0==r.status&&r.response?t(r.response):n()},r.onerror=n,r.send(null)});r["print"]||console.log.bind(console);var p=r["printErr"]||console.warn.bind(console);Object.assign(r,c),c=null,r["arguments"]&&(u=r["arguments"]),r["thisProgram"]&&r["thisProgram"],r["quit"]&&r["quit"];var m,v=4;r["wasmBinary"]&&(m=r["wasmBinary"]);var g;r["noExitRuntime"];"object"!=("undefined"===typeof WebAssembly?"undefined":t(WebAssembly))&&$("no native wasm support detected");var y,b,w,_,E,k,A,I,S,T=!1;function C(e,t,n){var r=t+n,i="";while(!(t>=r)){var o=e[t++];if(!o)return i;if(128&o){var a=63&e[t++];if(192!=(224&o)){var s=63&e[t++];if(o=224==(240&o)?(15&o)<<12|a<<6|s:(7&o)<<18|a<<12|s<<6|63&e[t++],o<65536)i+=String.fromCharCode(o);else{var c=o-65536;i+=String.fromCharCode(55296|c>>10,56320|1023&c)}}else i+=String.fromCharCode((31&o)<<6|a)}else i+=String.fromCharCode(o)}return i}function O(e,t){return e?C(w,e,t):""}function R(e,t,n,r){if(!(r>0))return 0;for(var i=n,o=n+r-1,a=0;a<e.length;++a){var s=e.charCodeAt(a);if(s>=55296&&s<=57343){var c=e.charCodeAt(++a);s=65536+((1023&s)<<10)|1023&c}if(s<=127){if(n>=o)break;t[n++]=s}else if(s<=2047){if(n+1>=o)break;t[n++]=192|s>>6,t[n++]=128|63&s}else if(s<=65535){if(n+2>=o)break;t[n++]=224|s>>12,t[n++]=128|s>>6&63,t[n++]=128|63&s}else{if(n+3>=o)break;t[n++]=240|s>>18,t[n++]=128|s>>12&63,t[n++]=128|s>>6&63,t[n++]=128|63&s}}return t[n]=0,n-i}function x(e,t,n){return R(e,w,t,n)}function P(e){for(var t=0,n=0;n<e.length;++n){var r=e.charCodeAt(n);r<=127?t++:r<=2047?t+=2:r>=55296&&r<=57343?(t+=4,++n):t+=3}return t}function F(e){y=e,r["HEAP8"]=b=new Int8Array(e),r["HEAP16"]=_=new Int16Array(e),r["HEAP32"]=k=new Int32Array(e),r["HEAPU8"]=w=new Uint8Array(e),r["HEAPU16"]=E=new Uint16Array(e),r["HEAPU32"]=A=new Uint32Array(e),r["HEAPF32"]=I=new Float32Array(e),r["HEAPF64"]=S=new Float64Array(e)}r["INITIAL_MEMORY"];var L,D=[],j=[],H=[];function M(){if(r["preRun"]){"function"==typeof r["preRun"]&&(r["preRun"]=[r["preRun"]]);while(r["preRun"].length)B(r["preRun"].shift())}ne(D)}function N(){!0,ne(j)}function U(){if(r["postRun"]){"function"==typeof r["postRun"]&&(r["postRun"]=[r["postRun"]]);while(r["postRun"].length)G(r["postRun"].shift())}ne(H)}function B(e){D.unshift(e)}function V(e){j.unshift(e)}function G(e){H.unshift(e)}var W=0,z=null,q=null;function K(e){W++,r["monitorRunDependencies"]&&r["monitorRunDependencies"](W)}function Y(e){if(W--,r["monitorRunDependencies"]&&r["monitorRunDependencies"](W),0==W&&(null!==z&&(clearInterval(z),z=null),q)){var t=q;q=null,t()}}function $(e){r["onAbort"]&&r["onAbort"](e),e="Aborted("+e+")",p(e),T=!0,1,e+=". Build with -sASSERTIONS for more info.";var t=new WebAssembly.RuntimeError(e);throw o(t),t}var X,Z="data:application/octet-stream;base64,";function J(e){return e.startsWith(Z)}function Q(e){try{if(e==X&&m)return new Uint8Array(m);if(s)return s(e);throw"both async and sync fetching of the wasm failed"}catch(e){$(e)}}function ee(){return m||!l&&!f||"function"!=typeof fetch?Promise.resolve().then((function(){return Q(X)})):fetch(X,{credentials:"same-origin"}).then((function(e){if(!e["ok"])throw"failed to load wasm binary file at '"+X+"'";return e["arrayBuffer"]()})).catch((function(){return Q(X)}))}function te(){var e={a:Ct};function t(e,t){var n=e.exports;r["asm"]=n,g=r["asm"]["x"],F(g.buffer),L=r["asm"]["B"],V(r["asm"]["y"]),Y("wasm-instantiate")}function n(e){t(e["instance"])}function i(t){return ee().then((function(t){return WebAssembly.instantiate(t,e)})).then((function(e){return e})).then(t,(function(e){p("failed to asynchronously prepare wasm: "+e),$(e)}))}function a(){return m||"function"!=typeof WebAssembly.instantiateStreaming||J(X)||"function"!=typeof fetch?i(n):fetch(X,{credentials:"same-origin"}).then((function(t){var r=WebAssembly.instantiateStreaming(t,e);return r.then(n,(function(e){return p("wasm streaming compile failed: "+e),p("falling back to ArrayBuffer instantiation"),i(n)}))}))}if(K("wasm-instantiate"),r["instantiateWasm"])try{var s=r["instantiateWasm"](e,t);return s}catch(a){p("Module.instantiateWasm callback failed with error: "+a),o(a)}return a().catch(o),{}}function ne(e){while(e.length>0)e.shift()(r)}function re(e,t,n,r){$("Assertion failed: "+O(e)+", at: "+[t?O(t):"unknown filename",n,r?O(r):"unknown function"])}function ie(e,t,n,r,i){}function oe(e){switch(e){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+e)}}function ae(){for(var e=new Array(256),t=0;t<256;++t)e[t]=String.fromCharCode(t);se=e}X="mp4-encoder.wasm",J(X)||(X=h(X));var se=void 0;function ce(e){var t="",n=e;while(w[n])t+=se[w[n++]];return t}var ue={},le={},fe={},de=48,he=57;function pe(e){if(void 0===e)return"_unknown";e=e.replace(/[^a-zA-Z0-9_]/g,"$");var t=e.charCodeAt(0);return t>=de&&t<=he?"_"+e:e}function me(e,t){return e=pe(e),new Function("body","return function "+e+'() {\n    "use strict";    return body.apply(this, arguments);\n};\n')(t)}function ve(e,t){var n=me(t,(function(e){this.name=t,this.message=e;var n=new Error(e).stack;void 0!==n&&(this.stack=this.toString()+"\n"+n.replace(/^Error(:[^\n]*)?\n/,""))}));return n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.prototype.toString=function(){return void 0===this.message?this.name:this.name+": "+this.message},n}var ge=void 0;function ye(e){throw new ge(e)}var be=void 0;function we(e){throw new be(e)}function _e(e,t,n){function r(t){var r=n(t);r.length!==e.length&&we("Mismatched type converter count");for(var i=0;i<e.length;++i)Ee(e[i],r[i])}e.forEach((function(e){fe[e]=t}));var i=new Array(t.length),o=[],a=0;t.forEach((function(e,t){le.hasOwnProperty(e)?i[t]=le[e]:(o.push(e),ue.hasOwnProperty(e)||(ue[e]=[]),ue[e].push((function(){i[t]=le[e],++a,a===o.length&&r(i)})))})),0===o.length&&r(i)}function Ee(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!("argPackAdvance"in t))throw new TypeError("registerType registeredInstance requires argPackAdvance");var r=t.name;if(e||ye('type "'+r+'" must have a positive integer typeid pointer'),le.hasOwnProperty(e)){if(n.ignoreDuplicateRegistrations)return;ye("Cannot register type '"+r+"' twice")}if(le[e]=t,delete fe[e],ue.hasOwnProperty(e)){var i=ue[e];delete ue[e],i.forEach((function(e){return e()}))}}function ke(e,t,n,r,i){var o=oe(n);t=ce(t),Ee(e,{name:t,fromWireType:function(e){return!!e},toWireType:function(e,t){return t?r:i},argPackAdvance:8,readValueFromPointer:function(e){var r;if(1===n)r=b;else if(2===n)r=_;else{if(4!==n)throw new TypeError("Unknown boolean type size: "+t);r=k}return this["fromWireType"](r[e>>o])},destructorFunction:null})}var Ae=[],Ie=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function Se(e){e>4&&0===--Ie[e].refcount&&(Ie[e]=void 0,Ae.push(e))}function Te(){for(var e=0,t=5;t<Ie.length;++t)void 0!==Ie[t]&&++e;return e}function Ce(){for(var e=5;e<Ie.length;++e)if(void 0!==Ie[e])return Ie[e];return null}function Oe(){r["count_emval_handles"]=Te,r["get_first_emval"]=Ce}var Re={toValue:function(e){return e||ye("Cannot use deleted val. handle = "+e),Ie[e].value},toHandle:function(e){switch(e){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:var t=Ae.length?Ae.pop():Ie.length;return Ie[t]={refcount:1,value:e},t}}};function xe(e){return this["fromWireType"](k[e>>2])}function Pe(e,t){t=ce(t),Ee(e,{name:t,fromWireType:function(e){var t=Re.toValue(e);return Se(e),t},toWireType:function(e,t){return Re.toHandle(t)},argPackAdvance:8,readValueFromPointer:xe,destructorFunction:null})}function Fe(e,t){switch(t){case 2:return function(e){return this["fromWireType"](I[e>>2])};case 3:return function(e){return this["fromWireType"](S[e>>3])};default:throw new TypeError("Unknown float type: "+e)}}function Le(e,t,n){var r=oe(n);t=ce(t),Ee(e,{name:t,fromWireType:function(e){return e},toWireType:function(e,t){return t},argPackAdvance:8,readValueFromPointer:Fe(t,r),destructorFunction:null})}function De(e,n){if(!(e instanceof Function))throw new TypeError("new_ called with constructor type "+t(e)+" which is not a function");var r=me(e.name||"unknownFunctionName",(function(){}));r.prototype=e.prototype;var i=new r,o=e.apply(i,n);return o instanceof Object?o:i}function je(e){while(e.length){var t=e.pop(),n=e.pop();n(t)}}function He(e,t,n,r,i){var o=t.length;o<2&&ye("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var a=null!==t[1]&&null!==n,s=!1,c=1;c<t.length;++c)if(null!==t[c]&&void 0===t[c].destructorFunction){s=!0;break}var u="void"!==t[0].name,l="",f="";for(c=0;c<o-2;++c)l+=(0!==c?", ":"")+"arg"+c,f+=(0!==c?", ":"")+"arg"+c+"Wired";var d="return function "+pe(e)+"("+l+") {\nif (arguments.length !== "+(o-2)+") {\nthrowBindingError('function "+e+" called with ' + arguments.length + ' arguments, expected "+(o-2)+" args!');\n}\n";s&&(d+="var destructors = [];\n");var h=s?"destructors":"null",p=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],m=[ye,r,i,je,t[0],t[1]];a&&(d+="var thisWired = classParam.toWireType("+h+", this);\n");for(c=0;c<o-2;++c)d+="var arg"+c+"Wired = argType"+c+".toWireType("+h+", arg"+c+"); // "+t[c+2].name+"\n",p.push("argType"+c),m.push(t[c+2]);if(a&&(f="thisWired"+(f.length>0?", ":"")+f),d+=(u?"var rv = ":"")+"invoker(fn"+(f.length>0?", ":"")+f+");\n",s)d+="runDestructors(destructors);\n";else for(c=a?1:2;c<t.length;++c){var v=1===c?"thisWired":"arg"+(c-2)+"Wired";null!==t[c].destructorFunction&&(d+=v+"_dtor("+v+"); // "+t[c].name+"\n",p.push(v+"_dtor"),m.push(t[c].destructorFunction))}u&&(d+="var ret = retType.fromWireType(rv);\nreturn ret;\n"),d+="}\n",p.push(d);var g=De(Function,p).apply(null,m);return g}function Me(e,t,n){if(void 0===e[t].overloadTable){var r=e[t];e[t]=function(){return e[t].overloadTable.hasOwnProperty(arguments.length)||ye("Function '"+n+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+e[t].overloadTable+")!"),e[t].overloadTable[arguments.length].apply(this,arguments)},e[t].overloadTable=[],e[t].overloadTable[r.argCount]=r}}function Ne(e,t,n){r.hasOwnProperty(e)?((void 0===n||void 0!==r[e].overloadTable&&void 0!==r[e].overloadTable[n])&&ye("Cannot register public name '"+e+"' twice"),Me(r,e,e),r.hasOwnProperty(n)&&ye("Cannot register multiple overloads of a function with the same number of arguments ("+n+")!"),r[e].overloadTable[n]=t):(r[e]=t,void 0!==n&&(r[e].numArguments=n))}function Ue(e,t){for(var n=[],r=0;r<e;r++)n.push(A[t+4*r>>2]);return n}function Be(e,t,n){r.hasOwnProperty(e)||we("Replacing nonexistant public symbol"),void 0!==r[e].overloadTable&&void 0!==n?r[e].overloadTable[n]=t:(r[e]=t,r[e].argCount=n)}function Ve(e,t,n){var i=r["dynCall_"+e];return n&&n.length?i.apply(null,[t].concat(n)):i.call(null,t)}var Ge=[];function We(e){var t=Ge[e];return t||(e>=Ge.length&&(Ge.length=e+1),Ge[e]=t=L.get(e)),t}function ze(e,t,n){if(e.includes("j"))return Ve(e,t,n);var r=We(t).apply(null,n);return r}function qe(e,t){var n=[];return function(){return n.length=0,Object.assign(n,arguments),ze(e,t,n)}}function Ke(e,t){function n(){return e.includes("j")?qe(e,t):We(t)}e=ce(e);var r=n();return"function"!=typeof r&&ye("unknown function pointer with signature "+e+": "+t),r}var Ye=void 0;function $e(e){var t=xt(e),n=ce(t);return Rt(t),n}function Xe(e,t){var n=[],r={};function i(e){r[e]||le[e]||(fe[e]?fe[e].forEach(i):(n.push(e),r[e]=!0))}throw t.forEach(i),new Ye(e+": "+n.map($e).join([", "]))}function Ze(e,t,n,r,i,o){var a=Ue(t,n);e=ce(e),i=Ke(r,i),Ne(e,(function(){Xe("Cannot call "+e+" due to unbound types",a)}),t-1),_e([],a,(function(n){var r=[n[0],null].concat(n.slice(1));return Be(e,He(e,r,null,i,o),t-1),[]}))}function Je(e,t,n){switch(t){case 0:return n?function(e){return b[e]}:function(e){return w[e]};case 1:return n?function(e){return _[e>>1]}:function(e){return E[e>>1]};case 2:return n?function(e){return k[e>>2]}:function(e){return A[e>>2]};default:throw new TypeError("Unknown integer type: "+e)}}function Qe(e,t,n,r,i){t=ce(t),-1===i&&(i=4294967295);var o=oe(n),a=function(e){return e};if(0===r){var s=32-8*n;a=function(e){return e<<s>>>s}}var c,u=t.includes("unsigned"),l=function(e,t){};c=u?function(e,t){return l(t,this.name),t>>>0}:function(e,t){return l(t,this.name),t},Ee(e,{name:t,fromWireType:a,toWireType:c,argPackAdvance:8,readValueFromPointer:Je(t,o,0!==r),destructorFunction:null})}function et(e,t,n){var r=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],i=r[t];function o(e){e>>=2;var t=A,n=t[e],r=t[e+1];return new i(y,r,n)}n=ce(n),Ee(e,{name:n,fromWireType:o,argPackAdvance:8,readValueFromPointer:o},{ignoreDuplicateRegistrations:!0})}function tt(e,t){t=ce(t);var n="std::string"===t;Ee(e,{name:t,fromWireType:function(e){var t,r=A[e>>2],i=e+4;if(n)for(var o=i,a=0;a<=r;++a){var s=i+a;if(a==r||0==w[s]){var c=s-o,u=O(o,c);void 0===t?t=u:(t+=String.fromCharCode(0),t+=u),o=s+1}}else{var l=new Array(r);for(a=0;a<r;++a)l[a]=String.fromCharCode(w[i+a]);t=l.join("")}return Rt(e),t},toWireType:function(e,t){var r;t instanceof ArrayBuffer&&(t=new Uint8Array(t));var i="string"==typeof t;i||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int8Array||ye("Cannot pass non-string to std::string"),r=n&&i?P(t):t.length;var o=Ot(4+r+1),a=o+4;if(A[o>>2]=r,n&&i)x(t,a,r+1);else if(i)for(var s=0;s<r;++s){var c=t.charCodeAt(s);c>255&&(Rt(a),ye("String has UTF-16 code units that do not fit in 8 bits")),w[a+s]=c}else for(s=0;s<r;++s)w[a+s]=t[s];return null!==e&&e.push(Rt,o),o},argPackAdvance:8,readValueFromPointer:xe,destructorFunction:function(e){Rt(e)}})}function nt(e,t){for(var n="",r=0;!(r>=t/2);++r){var i=_[e+2*r>>1];if(0==i)break;n+=String.fromCharCode(i)}return n}function rt(e,t,n){if(void 0===n&&(n=2147483647),n<2)return 0;n-=2;for(var r=t,i=n<2*e.length?n/2:e.length,o=0;o<i;++o){var a=e.charCodeAt(o);_[t>>1]=a,t+=2}return _[t>>1]=0,t-r}function it(e){return 2*e.length}function ot(e,t){var n=0,r="";while(!(n>=t/4)){var i=k[e+4*n>>2];if(0==i)break;if(++n,i>=65536){var o=i-65536;r+=String.fromCharCode(55296|o>>10,56320|1023&o)}else r+=String.fromCharCode(i)}return r}function at(e,t,n){if(void 0===n&&(n=2147483647),n<4)return 0;for(var r=t,i=r+n-4,o=0;o<e.length;++o){var a=e.charCodeAt(o);if(a>=55296&&a<=57343){var s=e.charCodeAt(++o);a=65536+((1023&a)<<10)|1023&s}if(k[t>>2]=a,t+=4,t+4>i)break}return k[t>>2]=0,t-r}function st(e){for(var t=0,n=0;n<e.length;++n){var r=e.charCodeAt(n);r>=55296&&r<=57343&&++n,t+=4}return t}function ct(e,t,n){var r,i,o,a,s;n=ce(n),2===t?(r=nt,i=rt,a=it,o=function(){return E},s=1):4===t&&(r=ot,i=at,a=st,o=function(){return A},s=2),Ee(e,{name:n,fromWireType:function(e){for(var n,i=A[e>>2],a=o(),c=e+4,u=0;u<=i;++u){var l=e+4+u*t;if(u==i||0==a[l>>s]){var f=l-c,d=r(c,f);void 0===n?n=d:(n+=String.fromCharCode(0),n+=d),c=l+t}}return Rt(e),n},toWireType:function(e,r){"string"!=typeof r&&ye("Cannot pass non-string to C++ string type "+n);var o=a(r),c=Ot(4+o+t);return A[c>>2]=o>>s,i(r,c+4,o+t),null!==e&&e.push(Rt,c),c},argPackAdvance:8,readValueFromPointer:xe,destructorFunction:function(e){Rt(e)}})}function ut(e,t){t=ce(t),Ee(e,{isVoid:!0,name:t,argPackAdvance:0,fromWireType:function(){},toWireType:function(e,t){}})}function lt(e,t){var n=le[e];return void 0===n&&ye(t+" has unknown type "+$e(e)),n}function ft(e,t,n){e=Re.toValue(e),t=lt(t,"emval::as");var r=[],i=Re.toHandle(r);return A[n>>2]=i,t["toWireType"](r,e)}function dt(e,t){for(var n=new Array(e),r=0;r<e;++r)n[r]=lt(A[t+r*v>>2],"parameter "+r);return n}function ht(e,t,n,r){e=Re.toValue(e);for(var i=dt(t,n),o=new Array(t),a=0;a<t;++a){var s=i[a];o[a]=s["readValueFromPointer"](r),r+=s["argPackAdvance"]}var c=e.apply(void 0,o);return Re.toHandle(c)}function pt(e,t){return e=Re.toValue(e),t=Re.toValue(t),Re.toHandle(e[t])}function mt(e){e>4&&(Ie[e].refcount+=1)}function vt(e){return e=Re.toValue(e),"number"==typeof e}var gt={};function yt(e){var t=gt[e];return void 0===t?ce(e):t}function bt(e){return Re.toHandle(yt(e))}function wt(e){var t=Re.toValue(e);je(t),Se(e)}function _t(e,t){e=lt(e,"_emval_take_value");var n=e["readValueFromPointer"](t);return Re.toHandle(n)}function Et(){$("")}function kt(e,t,n){w.copyWithin(e,t,t+n)}function At(){return 2147483648}function It(e){try{return g.grow(e-y.byteLength+65535>>>16),F(g.buffer),1}catch(e){}}function St(e){var t=w.length;e>>>=0;var n=At();if(e>n)return!1;for(var r=function(e,t){return e+(t-e%t)%t},i=1;i<=4;i*=2){var o=t*(1+.2/i);o=Math.min(o,e+100663296);var a=Math.min(n,r(Math.max(e,o),65536)),s=It(a);if(s)return!0}return!1}ae(),ge=r["BindingError"]=ve(Error,"BindingError"),be=r["InternalError"]=ve(Error,"InternalError"),Oe(),Ye=r["UnboundTypeError"]=ve(Error,"UnboundTypeError");var Tt,Ct={a:re,q:ie,u:ke,t:Pe,o:Le,h:Ze,d:Qe,c:et,n:tt,l:ct,v:ut,k:ft,w:ht,b:Se,e:pt,g:mt,p:vt,f:bt,j:wt,i:_t,m:Et,s:kt,r:St},Ot=(te(),r["___wasm_call_ctors"]=function(){return(r["___wasm_call_ctors"]=r["asm"]["y"]).apply(null,arguments)},r["_malloc"]=function(){return(Ot=r["_malloc"]=r["asm"]["z"]).apply(null,arguments)}),Rt=r["_free"]=function(){return(Rt=r["_free"]=r["asm"]["A"]).apply(null,arguments)},xt=r["___getTypeName"]=function(){return(xt=r["___getTypeName"]=r["asm"]["C"]).apply(null,arguments)};r["__embind_initialize_bindings"]=function(){return(r["__embind_initialize_bindings"]=r["asm"]["D"]).apply(null,arguments)},r["dynCall_ijiii"]=function(){return(r["dynCall_ijiii"]=r["asm"]["E"]).apply(null,arguments)};function Pt(e){function t(){Tt||(Tt=!0,r["calledRun"]=!0,T||(N(),i(r),r["onRuntimeInitialized"]&&r["onRuntimeInitialized"](),U()))}e=e||u,W>0||(M(),W>0||(r["setStatus"]?(r["setStatus"]("Running..."),setTimeout((function(){setTimeout((function(){r["setStatus"]("")}),1),t()}),1)):t()))}if(q=function e(){Tt||Pt(),Tt||(q=e)},r["preInit"]){"function"==typeof r["preInit"]&&(r["preInit"]=[r["preInit"]]);while(r["preInit"].length>0)r["preInit"].pop()()}return Pt(),r.ready}}(),i=r;function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:256,t=0,n=0,r=new Uint8Array(e);return{contents:function(){return r.slice(0,n)},seek:function(e){t=e},write:function(e){var o=e.byteLength;return i(t+o),r.set(e,t),t+=o,n=Math.max(n,t),o}};function i(e){var t=r.length;if(!(t>=e)){var i=1048576;e=Math.max(e,t*(t<i?2:1.125)>>>0),0!=t&&(e=Math.max(e,256));var o=r;r=new Uint8Array(e),n>0&&r.set(o.subarray(0,n),0)}}}function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.width,r=t.height,i=t.fps,a=void 0===i?30:i,s=t.fragmentation,c=void 0!==s&&s,u=t.sequential,l=void 0!==u&&u,f=t.hevc,d=void 0!==f&&f;if("number"!==typeof n||"number"!==typeof r)throw new Error("Must specify { width, height } options");if(!isFinite(n)||n<0||!isFinite(r)||r<0)throw new Error("{ width, height } options must be positive integers");var h=o(),p=e.create_muxer({width:n,height:r,fps:a,fragmentation:c,sequential:l,hevc:d},m);return{end:function(){return e.finalize_muxer(p),h.contents()},addNalu:function(t){var n=e._malloc(t.byteLength);e.HEAPU8.set(t,n),e.mux_nal(p,n,t.byteLength),e._free(n)}};function m(t,n,r){h.seek(r);var i=e.HEAPU8.subarray(t,t+n);return h.write(i)!==i.byteLength}}n.default=i,r.createFile=o}).call(this)}).call(this,e("_process"))},{_process:2}],18:[function(e,t,n){"use strict";"undefined"===typeof ArrayBuffer||ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=function(e,t){var n=new Uint8Array(this);void 0===t&&(t=n.length);for(var r=new ArrayBuffer(t-e),i=new Uint8Array(r),o=0;o<i.length;o++)i[o]=n[o+e];return r})},{}],19:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=function(){function e(t){r(this,e),t&&t.xhrSetup&&(this.xhrSetup=t.xhrSetup)}return o(e,[{key:"destroy",value:function(){this.abort(),this.loader=null}},{key:"abort",value:function(){var e=this.loader;e&&4!==e.readyState&&(this.stats.aborted=!0,e.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null}},{key:"loadHead",value:function(e,t,n){this.context=e,this.config=t,this.callbacks=n,this.stats={trequest:performance.now(),retry:0},this.retryDelay=t.retryDelay;var r=new XMLHttpRequest;r.open("head",e.url),r.onload=function(){n.onSuccess(r.getResponseHeader("content-length"))},r.send()}},{key:"load",value:function(e,t,n){this.context=e,this.config=t,this.callbacks=n,this.stats={trequest:performance.now(),retry:0},this.retryDelay=t.retryDelay,this.loadInternal()}},{key:"loadInternal",value:function(){var e,t=this.context;e="undefined"!==typeof XDomainRequest?this.loader=new XDomainRequest:this.loader=new XMLHttpRequest,e.onloadend=this.loadend.bind(this),e.onprogress=this.loadprogress.bind(this),e.open("GET",t.url,!0),t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.responseType=t.responseType;var n=this.stats;n.tfirst=0,n.loaded=0,this.xhrSetup&&this.xhrSetup(e,t.url),this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),e.send()}},{key:"loadend",value:function(e){var t=e.currentTarget,n=t.status,r=this.stats,i=this.context,o=this.config;if(!r.aborted)if(window.clearTimeout(this.requestTimeout),n>=200&&n<300){var a,s;r.tload=Math.max(r.tfirst,performance.now()),"arraybuffer"===i.responseType?(a=t.response,s=a.byteLength):(a=t.responseText,s=a.length),r.loaded=r.total=s;var c={url:t.responseURL,data:a};this.callbacks.onSuccess(c,r,i)}else r.retry>=o.maxRetry||n>=400&&n<499?this.callbacks.onError({code:n,text:t.statusText},i):(this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,o.maxRetryDelay),r.retry++)}},{key:"loadtimeout",value:function(){this.callbacks.onTimeout(this.stats,this.context)}},{key:"loadprogress",value:function(e){var t=this.stats;0===t.tfirst&&(t.tfirst=Math.max(performance.now(),t.trequest)),t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total);var n=this.callbacks.onProgress;n&&n(t,this.context,null)}}]),e}(),s=a;n.default=s},{}],20:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("./errors"),i=l(e("./events")),o=l(e("./controller/flow-controller")),a=l(e("./controller/buffer-controller")),s=l(e("events")),c=l(e("./utils/xhr-loader")),u=(l(e("./loader/file-loader")),l(e("./loader/websocket-loader")));function l(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var p=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};f(this,e);var n=e.DefaultConfig;for(var r in n)r in t||(t[r]=n[r]);this.config=t;var i=this.observer=new s.default;i.trigger=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];i.emit.apply(i,[e,e].concat(n))},i.off=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];i.removeListener.apply(i,[e].concat(n))},this.on=i.on.bind(i),this.off=i.off.bind(i),this.trigger=i.trigger.bind(i),this.flowController=new o.default(this),this.bufferController=new a.default(this),this.websocketLoader=new u.default(this),this.mediaType=void 0,this.extraData=void 0}return h(e,[{key:"destroy",value:function(){console.log("wfs destroy +++"),this.flowController.destroy(),this.bufferController.destroy(),this.websocketLoader.destroy(),console.log("wfs destroy ---")}},{key:"attachMedia",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"chX",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"H264Raw",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"play2",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;this.mediaType=n,this.media=e,this.extraData=o;var a=void 0;switch(n){case"MJPEG":a=i.default.MEDIA_ATTACHED;break;case"H264Raw":default:a=i.default.MEDIA_ATTACHING;break}this.trigger(a,{media:e,channelName:t,mediaType:n,websocketName:r,extraData:this.extraData})}},{key:"attachWebsocket",value:function(e,t,n){this.trigger(i.default.WEBSOCKET_ATTACHING,{websocket:e,websocketName:t,media:this.media,mediaType:this.mediaType,channelName:n,extraData:this.extraData})}},{key:"start_recording",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1073741824,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;this.trigger(i.default.RECORDING_START,{rec_file_threshold:e,result_cb:t,state_cb:n})}},{key:"playerSeekNow",value:function(){this.trigger(i.default.PLAYER_SEEK_NOW)}},{key:"stop_recording",value:function(){this.trigger(i.default.RECORDING_STOP)}}],[{key:"version",get:function(){return"v.0.0.0.1"}},{key:"isSupported",value:function(){return window.MediaSource&&"function"===typeof window.MediaSource.isTypeSupported&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42c01f,mp4a.40.2"')}},{key:"Events",get:function(){return i.default}},{key:"ErrorTypes",get:function(){return r.ErrorTypes}},{key:"ErrorDetails",get:function(){return r.ErrorDetails}},{key:"DefaultConfig",get:function(){return e.defaultConfig||(e.defaultConfig={autoStartLoad:!0,startPosition:-1,debug:!1,fLoader:void 0,loader:c.default,fmp4FileUrl:"xxxx.mp4",fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,fragLoadingLoopThreshold:3,forceKeyFrameOnDiscontinuity:!0,appendErrorMaxRetry:3,wsMinPacketInterval:3e3,wsMaxPacketInterval:3e4,mp4Duration:1e3}),e.defaultConfig},set:function(t){e.defaultConfig=t}}]),e}(),m=p;n.default=m},{"./controller/buffer-controller":3,"./controller/flow-controller":4,"./errors":7,"./events":9,"./loader/file-loader":12,"./loader/websocket-loader":13,"./utils/xhr-loader":19,events:1}]},{},[11])(11)}))}}]);